Batch size 16
Number of GPUs we have: 2
Len  {'clean': <tf.Tensor 'ParseExample/ParseExampleV2:0' shape=(16, 160000) dtype=float32>, 'noisy': <tf.Tensor 'ParseExample/ParseExampleV2:1' shape=(16, 160000) dtype=float32>}
Batch size 16
Number of GPUs we have: 2
Len  {'clean': <tf.Tensor 'ParseExample/ParseExampleV2:0' shape=(16, 160000) dtype=float32>, 'noisy': <tf.Tensor 'ParseExample/ParseExampleV2:1' shape=(16, 160000) dtype=float32>}
Model: "demucs"
__________________________________________________________________________________________________
 Layer (type)                   Output Shape         Param #     Connected to                     
==================================================================================================
 input_layer (InputLayer)       [(None, 160000, 1)]  0           []                               
                                                                                                  
 tf.math.reduce_std (TFOpLambda  (None, 1, 1)        0           ['input_layer[0][0]']            
 )                                                                                                
                                                                                                  
 tf.__operators__.add (TFOpLamb  (None, 1, 1)        0           ['tf.math.reduce_std[0][0]']     
 da)                                                                                              
                                                                                                  
 tf.math.truediv (TFOpLambda)   (None, 160000, 1)    0           ['input_layer[0][0]',            
                                                                  'tf.__operators__.add[0][0]']   
                                                                                                  
 tf.compat.v1.pad (TFOpLambda)  (None, 160085, 1)    0           ['tf.math.truediv[0][0]']        
                                                                                                  
 tf.reshape (TFOpLambda)        (None, 160085, 1)    0           ['tf.compat.v1.pad[0][0]']       
                                                                                                  
 tf.compat.v1.nn.conv1d (TFOpLa  (None, 160085, 1)   0           ['tf.reshape[0][0]']             
 mbda)                                                                                            
                                                                                                  
 tf.reshape_1 (TFOpLambda)      (None, 160085, 1)    0           ['tf.compat.v1.nn.conv1d[0][0]'] 
                                                                                                  
 tf.stack (TFOpLambda)          (None, 160085, 2, 1  0           ['tf.compat.v1.pad[0][0]',       
                                )                                 'tf.reshape_1[0][0]']           
                                                                                                  
 tf.reshape_2 (TFOpLambda)      (None, 320170, 1)    0           ['tf.stack[0][0]']               
                                                                                                  
 tf.reshape_3 (TFOpLambda)      (None, 320170, 1)    0           ['tf.reshape_2[0][0]']           
                                                                                                  
 tf.compat.v1.nn.conv1d_1 (TFOp  (None, 320170, 1)   0           ['tf.reshape_3[0][0]']           
 Lambda)                                                                                          
                                                                                                  
 tf.reshape_4 (TFOpLambda)      (None, 320170, 1)    0           ['tf.compat.v1.nn.conv1d_1[0][0]'
                                                                 ]                                
                                                                                                  
 tf.stack_1 (TFOpLambda)        (None, 320170, 2, 1  0           ['tf.reshape_2[0][0]',           
                                )                                 'tf.reshape_4[0][0]']           
                                                                                                  
 tf.reshape_5 (TFOpLambda)      (None, 640340, 1)    0           ['tf.stack_1[0][0]']             
                                                                                                  
 encode_0 (Sequential)          (None, 160084, 64)   8896        ['tf.reshape_5[0][0]']           
                                                                                                  
 encode_1 (Sequential)          (None, 40020, 128)   98688       ['encode_0[0][0]']               
                                                                                                  
 encode_2 (Sequential)          (None, 10004, 256)   393984      ['encode_1[0][0]']               
                                                                                                  
 encode_3 (Sequential)          (None, 2500, 512)    1574400     ['encode_2[0][0]']               
                                                                                                  
 encode_4 (Sequential)          (None, 624, 1024)    6294528     ['encode_3[0][0]']               
                                                                                                  
 sequential (Sequential)        (None, 624, 1024)    16785408    ['encode_4[0][0]']               
                                                                                                  
 tf.identity_4 (TFOpLambda)     (None, 624, 1024)    0           ['encode_4[0][0]']               
                                                                                                  
 tf.math.add (TFOpLambda)       (None, 624, 1024)    0           ['sequential[0][0]',             
                                                                  'tf.identity_4[0][0]']          
                                                                                                  
 decode_4 (Sequential)          (None, 2500, 512)    6294016     ['tf.math.add[0][0]']            
                                                                                                  
 tf.identity_3 (TFOpLambda)     (None, 2500, 512)    0           ['encode_3[0][0]']               
                                                                                                  
 tf.math.add_1 (TFOpLambda)     (None, 2500, 512)    0           ['decode_4[0][0]',               
                                                                  'tf.identity_3[0][0]']          
                                                                                                  
 decode_3 (Sequential)          (None, 10004, 256)   1574144     ['tf.math.add_1[0][0]']          
                                                                                                  
 tf.identity_2 (TFOpLambda)     (None, 10004, 256)   0           ['encode_2[0][0]']               
                                                                                                  
 tf.math.add_2 (TFOpLambda)     (None, 10004, 256)   0           ['decode_3[0][0]',               
                                                                  'tf.identity_2[0][0]']          
                                                                                                  
 decode_2 (Sequential)          (None, 40020, 128)   393856      ['tf.math.add_2[0][0]']          
                                                                                                  
 tf.identity_1 (TFOpLambda)     (None, 40020, 128)   0           ['encode_1[0][0]']               
                                                                                                  
 tf.math.add_3 (TFOpLambda)     (None, 40020, 128)   0           ['decode_2[0][0]',               
                                                                  'tf.identity_1[0][0]']          
                                                                                                  
 decode_1 (Sequential)          (None, 160084, 64)   98624       ['tf.math.add_3[0][0]']          
                                                                                                  
 tf.identity (TFOpLambda)       (None, 160084, 64)   0           ['encode_0[0][0]']               
                                                                                                  
 tf.math.add_4 (TFOpLambda)     (None, 160084, 64)   0           ['decode_1[0][0]',               
                                                                  'tf.identity[0][0]']            
                                                                                                  
 decode_0 (Sequential)          (None, 640340, 1)    8833        ['tf.math.add_4[0][0]']          
                                                                                                  
 tf.__operators__.getitem_1 (Sl  (None, 320170, 1)   0           ['decode_0[0][0]']               
 icingOpLambda)                                                                                   
                                                                                                  
 tf.reshape_6 (TFOpLambda)      (None, 320170, 1)    0           ['tf.__operators__.getitem_1[0][0
                                                                 ]']                              
                                                                                                  
 tf.compat.v1.pad_1 (TFOpLambda  (None, 320172, 1)   0           ['tf.reshape_6[0][0]']           
 )                                                                                                
                                                                                                  
 tf.compat.v1.nn.conv1d_2 (TFOp  (None, 320172, 1)   0           ['tf.compat.v1.pad_1[0][0]']     
 Lambda)                                                                                          
                                                                                                  
 tf.__operators__.getitem_2 (Sl  (None, 320170, 1)   0           ['tf.compat.v1.nn.conv1d_2[0][0]'
 icingOpLambda)                                                  ]                                
                                                                                                  
 tf.__operators__.getitem (Slic  (None, 320170, 1)   0           ['decode_0[0][0]']               
 ingOpLambda)                                                                                     
                                                                                                  
 tf.reshape_7 (TFOpLambda)      (None, 320170, 1)    0           ['tf.__operators__.getitem_2[0][0
                                                                 ]']                              
                                                                                                  
 tf.__operators__.add_1 (TFOpLa  (None, 320170, 1)   0           ['tf.__operators__.getitem[0][0]'
 mbda)                                                           , 'tf.reshape_7[0][0]']          
                                                                                                  
 tf.reshape_8 (TFOpLambda)      (None, 320170, 1)    0           ['tf.__operators__.add_1[0][0]'] 
                                                                                                  
 tf.math.multiply (TFOpLambda)  (None, 320170, 1)    0           ['tf.reshape_8[0][0]']           
                                                                                                  
 tf.__operators__.getitem_4 (Sl  (None, 160085, 1)   0           ['tf.math.multiply[0][0]']       
 icingOpLambda)                                                                                   
                                                                                                  
 tf.reshape_9 (TFOpLambda)      (None, 160085, 1)    0           ['tf.__operators__.getitem_4[0][0
                                                                 ]']                              
                                                                                                  
 tf.compat.v1.pad_2 (TFOpLambda  (None, 160087, 1)   0           ['tf.reshape_9[0][0]']           
 )                                                                                                
                                                                                                  
 tf.compat.v1.nn.conv1d_3 (TFOp  (None, 160087, 1)   0           ['tf.compat.v1.pad_2[0][0]']     
 Lambda)                                                                                          
                                                                                                  
 tf.__operators__.getitem_5 (Sl  (None, 160085, 1)   0           ['tf.compat.v1.nn.conv1d_3[0][0]'
 icingOpLambda)                                                  ]                                
                                                                                                  
 tf.__operators__.getitem_3 (Sl  (None, 160085, 1)   0           ['tf.math.multiply[0][0]']       
 icingOpLambda)                                                                                   
                                                                                                  
 tf.reshape_10 (TFOpLambda)     (None, 160085, 1)    0           ['tf.__operators__.getitem_5[0][0
                                                                 ]']                              
                                                                                                  
 tf.__operators__.add_2 (TFOpLa  (None, 160085, 1)   0           ['tf.__operators__.getitem_3[0][0
 mbda)                                                           ]',                              
                                                                  'tf.reshape_10[0][0]']          
                                                                                                  
 tf.reshape_11 (TFOpLambda)     (None, 160085, 1)    0           ['tf.__operators__.add_2[0][0]'] 
                                                                                                  
 tf.math.multiply_1 (TFOpLambda  (None, 160085, 1)   0           ['tf.reshape_11[0][0]']          
 )                                                                                                
                                                                                                  
 tf.__operators__.getitem_6 (Sl  (None, 160000, 1)   0           ['tf.math.multiply_1[0][0]']     
 icingOpLambda)                                                                                   
                                                                                                  
 tf.math.multiply_2 (TFOpLambda  (None, 160000, 1)   0           ['tf.__operators__.getitem_6[0][0
 )                                                               ]',                              
                                                                  'tf.math.reduce_std[0][0]']     
                                                                                                  
==================================================================================================
Total params: 33,525,377
Trainable params: 33,525,377
Non-trainable params: 0
__________________________________________________________________________________________________
None
Created a new model
Len  {'clean': <tf.Tensor 'ParseExample/ParseExampleV2:0' shape=(16, 160000) dtype=float32>, 'noisy': <tf.Tensor 'ParseExample/ParseExampleV2:1' shape=(16, 160000) dtype=float32>}
Epoch 1/10
 1/10 [==>...........................] - ETA: 3:22 - loss: 0.0332 2/10 [=====>........................] - ETA: 12s - loss: 0.0324  3/10 [========>.....................] - ETA: 10s - loss: 0.0317 4/10 [===========>..................] - ETA: 8s - loss: 0.0317  5/10 [==============>...............] - ETA: 7s - loss: 0.0340 6/10 [=================>............] - ETA: 5s - loss: 0.0339 7/10 [====================>.........] - ETA: 4s - loss: 0.0337 8/10 [=======================>......] - ETA: 2s - loss: 0.0339 9/10 [==========================>...] - ETA: 1s - loss: 0.033910/10 [==============================] - ETA: 0s - loss: 0.034410/10 [==============================] - 44s 2s/step - loss: 0.0344 - val_loss: 0.0293
Epoch 2/10
 1/10 [==>...........................] - ETA: 7s - loss: 0.0356 2/10 [=====>........................] - ETA: 6s - loss: 0.0347 3/10 [========>.....................] - ETA: 5s - loss: 0.0376 4/10 [===========>..................] - ETA: 5s - loss: 0.0381 5/10 [==============>...............] - ETA: 4s - loss: 0.0378 6/10 [=================>............] - ETA: 3s - loss: 0.0366 7/10 [====================>.........] - ETA: 2s - loss: 0.0372 8/10 [=======================>......] - ETA: 1s - loss: 0.0371 9/10 [==========================>...] - ETA: 0s - loss: 0.037210/10 [==============================] - ETA: 0s - loss: 0.037910/10 [==============================] - 11s 1s/step - loss: 0.0379 - val_loss: 0.0293
Epoch 3/10
 1/10 [==>...........................] - ETA: 8s - loss: 0.0390 2/10 [=====>........................] - ETA: 7s - loss: 0.0411 3/10 [========>.....................] - ETA: 6s - loss: 0.0385 4/10 [===========>..................] - ETA: 5s - loss: 0.0359 5/10 [==============>...............] - ETA: 4s - loss: 0.0335 6/10 [=================>............] - ETA: 3s - loss: 0.0327 7/10 [====================>.........] - ETA: 2s - loss: 0.0320 8/10 [=======================>......] - ETA: 1s - loss: 0.0317 9/10 [==========================>...] - ETA: 0s - loss: 0.032210/10 [==============================] - ETA: 0s - loss: 0.032510/10 [==============================] - 11s 1s/step - loss: 0.0325 - val_loss: 0.0296
Epoch 4/10
 1/10 [==>...........................] - ETA: 7s - loss: 0.0291 2/10 [=====>........................] - ETA: 6s - loss: 0.0300 3/10 [========>.....................] - ETA: 6s - loss: 0.0300 4/10 [===========>..................] - ETA: 5s - loss: 0.0302 5/10 [==============>...............] - ETA: 4s - loss: 0.0302 6/10 [=================>............] - ETA: 3s - loss: 0.0299 7/10 [====================>.........] - ETA: 2s - loss: 0.0289 8/10 [=======================>......] - ETA: 1s - loss: 0.0288 9/10 [==========================>...] - ETA: 0s - loss: 0.028010/10 [==============================] - ETA: 0s - loss: 0.027610/10 [==============================] - 11s 1s/step - loss: 0.0276 - val_loss: 0.0259
Epoch 5/10
 1/10 [==>...........................] - ETA: 7s - loss: 0.0249 2/10 [=====>........................] - ETA: 7s - loss: 0.0253 3/10 [========>.....................] - ETA: 6s - loss: 0.0254 4/10 [===========>..................] - ETA: 5s - loss: 0.0262 5/10 [==============>...............] - ETA: 4s - loss: 0.0260 6/10 [=================>............] - ETA: 3s - loss: 0.0254 7/10 [====================>.........] - ETA: 2s - loss: 0.0261 8/10 [=======================>......] - ETA: 1s - loss: 0.0257 9/10 [==========================>...] - ETA: 0s - loss: 0.025710/10 [==============================] - ETA: 0s - loss: 0.025210/10 [==============================] - 11s 1s/step - loss: 0.0252 - val_loss: 0.0230
Epoch 6/10
 1/10 [==>...........................] - ETA: 7s - loss: 0.0273 2/10 [=====>........................] - ETA: 6s - loss: 0.0247 3/10 [========>.....................] - ETA: 5s - loss: 0.0270 4/10 [===========>..................] - ETA: 5s - loss: 0.0273 5/10 [==============>...............] - ETA: 4s - loss: 0.0263 6/10 [=================>............] - ETA: 3s - loss: 0.0259 7/10 [====================>.........] - ETA: 2s - loss: 0.0260 8/10 [=======================>......] - ETA: 1s - loss: 0.0260 9/10 [==========================>...] - ETA: 0s - loss: 0.025110/10 [==============================] - ETA: 0s - loss: 0.025010/10 [==============================] - 11s 1s/step - loss: 0.0250 - val_loss: 0.0230
Epoch 7/10
 1/10 [==>...........................] - ETA: 7s - loss: 0.0267 2/10 [=====>........................] - ETA: 7s - loss: 0.0303 3/10 [========>.....................] - ETA: 6s - loss: 0.0278 4/10 [===========>..................] - ETA: 5s - loss: 0.0300 5/10 [==============>...............] - ETA: 4s - loss: 0.0293 6/10 [=================>............] - ETA: 3s - loss: 0.0294 7/10 [====================>.........] - ETA: 2s - loss: 0.0299 8/10 [=======================>......] - ETA: 1s - loss: 0.0300 9/10 [==========================>...] - ETA: 0s - loss: 0.029210/10 [==============================] - ETA: 0s - loss: 0.029310/10 [==============================] - 11s 1s/step - loss: 0.0293 - val_loss: 0.0256
Epoch 8/10
 1/10 [==>...........................] - ETA: 7s - loss: 0.0395 2/10 [=====>........................] - ETA: 6s - loss: 0.0329 3/10 [========>.....................] - ETA: 6s - loss: 0.0334 4/10 [===========>..................] - ETA: 5s - loss: 0.0314 5/10 [==============>...............] - ETA: 4s - loss: 0.0311 6/10 [=================>............] - ETA: 3s - loss: 0.0299 7/10 [====================>.........] - ETA: 2s - loss: 0.0292 8/10 [=======================>......] - ETA: 1s - loss: 0.0293 9/10 [==========================>...] - ETA: 0s - loss: 0.029110/10 [==============================] - ETA: 0s - loss: 0.028810/10 [==============================] - 11s 1s/step - loss: 0.0288 - val_loss: 0.0251
Epoch 9/10
 1/10 [==>...........................] - ETA: 7s - loss: 0.0267 2/10 [=====>........................] - ETA: 7s - loss: 0.0304 3/10 [========>.....................] - ETA: 6s - loss: 0.0276 4/10 [===========>..................] - ETA: 5s - loss: 0.0288 5/10 [==============>...............] - ETA: 4s - loss: 0.0285 6/10 [=================>............] - ETA: 3s - loss: 0.0293 7/10 [====================>.........] - ETA: 2s - loss: 0.0288 8/10 [=======================>......] - ETA: 1s - loss: 0.0287 9/10 [==========================>...] - ETA: 0s - loss: 0.028910/10 [==============================] - ETA: 0s - loss: 0.028910/10 [==============================] - 11s 1s/step - loss: 0.0289 - val_loss: 0.0238
Epoch 10/10
 1/10 [==>...........................] - ETA: 7s - loss: 0.0272 2/10 [=====>........................] - ETA: 7s - loss: 0.0251 3/10 [========>.....................] - ETA: 6s - loss: 0.0260 4/10 [===========>..................] - ETA: 5s - loss: 0.0261 5/10 [==============>...............] - ETA: 4s - loss: 0.0250 6/10 [=================>............] - ETA: 3s - loss: 0.0254 7/10 [====================>.........] - ETA: 2s - loss: 0.0248 8/10 [=======================>......] - ETA: 1s - loss: 0.0255 9/10 [==========================>...] - ETA: 0s - loss: 0.025210/10 [==============================] - ETA: 0s - loss: 0.024810/10 [==============================] - 11s 1s/step - loss: 0.0248 - val_loss: 0.0238
done


Batch size 16
Number of GPUs we have: 2
Len  {'clean': <tf.Tensor 'ParseExample/ParseExampleV2:0' shape=(16, 160000) dtype=float32>, 'noisy': <tf.Tensor 'ParseExample/ParseExampleV2:1' shape=(16, 160000) dtype=float32>}
Model: "demucs"
__________________________________________________________________________________________________
 Layer (type)                   Output Shape         Param #     Connected to                     
==================================================================================================
 input_layer (InputLayer)       [(None, 160000, 1)]  0           []                               
                                                                                                  
 tf.math.reduce_std (TFOpLambda  (None, 1, 1)        0           ['input_layer[0][0]']            
 )                                                                                                
                                                                                                  
 tf.__operators__.add (TFOpLamb  (None, 1, 1)        0           ['tf.math.reduce_std[0][0]']     
 da)                                                                                              
                                                                                                  
 tf.math.truediv (TFOpLambda)   (None, 160000, 1)    0           ['input_layer[0][0]',            
                                                                  'tf.__operators__.add[0][0]']   
                                                                                                  
 tf.compat.v1.pad (TFOpLambda)  (None, 160085, 1)    0           ['tf.math.truediv[0][0]']        
                                                                                                  
 tf.reshape (TFOpLambda)        (None, 160085, 1)    0           ['tf.compat.v1.pad[0][0]']       
                                                                                                  
 tf.compat.v1.nn.conv1d (TFOpLa  (None, 160085, 1)   0           ['tf.reshape[0][0]']             
 mbda)                                                                                            
                                                                                                  
 tf.reshape_1 (TFOpLambda)      (None, 160085, 1)    0           ['tf.compat.v1.nn.conv1d[0][0]'] 
                                                                                                  
 tf.stack (TFOpLambda)          (None, 160085, 2, 1  0           ['tf.compat.v1.pad[0][0]',       
                                )                                 'tf.reshape_1[0][0]']           
                                                                                                  
 tf.reshape_2 (TFOpLambda)      (None, 320170, 1)    0           ['tf.stack[0][0]']               
                                                                                                  
 tf.reshape_3 (TFOpLambda)      (None, 320170, 1)    0           ['tf.reshape_2[0][0]']           
                                                                                                  
 tf.compat.v1.nn.conv1d_1 (TFOp  (None, 320170, 1)   0           ['tf.reshape_3[0][0]']           
 Lambda)                                                                                          
                                                                                                  
 tf.reshape_4 (TFOpLambda)      (None, 320170, 1)    0           ['tf.compat.v1.nn.conv1d_1[0][0]'
                                                                 ]                                
                                                                                                  
 tf.stack_1 (TFOpLambda)        (None, 320170, 2, 1  0           ['tf.reshape_2[0][0]',           
                                )                                 'tf.reshape_4[0][0]']           
                                                                                                  
 tf.reshape_5 (TFOpLambda)      (None, 640340, 1)    0           ['tf.stack_1[0][0]']             
                                                                                                  
 encode_0 (Sequential)          (None, 160084, 64)   8896        ['tf.reshape_5[0][0]']           
                                                                                                  
 encode_1 (Sequential)          (None, 40020, 128)   98688       ['encode_0[0][0]']               
                                                                                                  
 encode_2 (Sequential)          (None, 10004, 256)   393984      ['encode_1[0][0]']               
                                                                                                  
 encode_3 (Sequential)          (None, 2500, 512)    1574400     ['encode_2[0][0]']               
                                                                                                  
 encode_4 (Sequential)          (None, 624, 1024)    6294528     ['encode_3[0][0]']               
                                                                                                  
 sequential (Sequential)        (None, 624, 1024)    16785408    ['encode_4[0][0]']               
                                                                                                  
 tf.identity_4 (TFOpLambda)     (None, 624, 1024)    0           ['encode_4[0][0]']               
                                                                                                  
 tf.math.add (TFOpLambda)       (None, 624, 1024)    0           ['sequential[0][0]',             
                                                                  'tf.identity_4[0][0]']          
                                                                                                  
 decode_4 (Sequential)          (None, 2500, 512)    6294016     ['tf.math.add[0][0]']            
                                                                                                  
 tf.identity_3 (TFOpLambda)     (None, 2500, 512)    0           ['encode_3[0][0]']               
                                                                                                  
 tf.math.add_1 (TFOpLambda)     (None, 2500, 512)    0           ['decode_4[0][0]',               
                                                                  'tf.identity_3[0][0]']          
                                                                                                  
 decode_3 (Sequential)          (None, 10004, 256)   1574144     ['tf.math.add_1[0][0]']          
                                                                                                  
 tf.identity_2 (TFOpLambda)     (None, 10004, 256)   0           ['encode_2[0][0]']               
                                                                                                  
 tf.math.add_2 (TFOpLambda)     (None, 10004, 256)   0           ['decode_3[0][0]',               
                                                                  'tf.identity_2[0][0]']          
                                                                                                  
 decode_2 (Sequential)          (None, 40020, 128)   393856      ['tf.math.add_2[0][0]']          
                                                                                                  
 tf.identity_1 (TFOpLambda)     (None, 40020, 128)   0           ['encode_1[0][0]']               
                                                                                                  
 tf.math.add_3 (TFOpLambda)     (None, 40020, 128)   0           ['decode_2[0][0]',               
                                                                  'tf.identity_1[0][0]']          
                                                                                                  
 decode_1 (Sequential)          (None, 160084, 64)   98624       ['tf.math.add_3[0][0]']          
                                                                                                  
 tf.identity (TFOpLambda)       (None, 160084, 64)   0           ['encode_0[0][0]']               
                                                                                                  
 tf.math.add_4 (TFOpLambda)     (None, 160084, 64)   0           ['decode_1[0][0]',               
                                                                  'tf.identity[0][0]']            
                                                                                                  
 decode_0 (Sequential)          (None, 640340, 1)    8833        ['tf.math.add_4[0][0]']          
                                                                                                  
 tf.__operators__.getitem_1 (Sl  (None, 320170, 1)   0           ['decode_0[0][0]']               
 icingOpLambda)                                                                                   
                                                                                                  
 tf.reshape_6 (TFOpLambda)      (None, 320170, 1)    0           ['tf.__operators__.getitem_1[0][0
                                                                 ]']                              
                                                                                                  
 tf.compat.v1.pad_1 (TFOpLambda  (None, 320172, 1)   0           ['tf.reshape_6[0][0]']           
 )                                                                                                
                                                                                                  
 tf.compat.v1.nn.conv1d_2 (TFOp  (None, 320172, 1)   0           ['tf.compat.v1.pad_1[0][0]']     
 Lambda)                                                                                          
                                                                                                  
 tf.__operators__.getitem_2 (Sl  (None, 320170, 1)   0           ['tf.compat.v1.nn.conv1d_2[0][0]'
 icingOpLambda)                                                  ]                                
                                                                                                  
 tf.__operators__.getitem (Slic  (None, 320170, 1)   0           ['decode_0[0][0]']               
 ingOpLambda)                                                                                     
                                                                                                  
 tf.reshape_7 (TFOpLambda)      (None, 320170, 1)    0           ['tf.__operators__.getitem_2[0][0
                                                                 ]']                              
                                                                                                  
 tf.__operators__.add_1 (TFOpLa  (None, 320170, 1)   0           ['tf.__operators__.getitem[0][0]'
 mbda)                                                           , 'tf.reshape_7[0][0]']          
                                                                                                  
 tf.reshape_8 (TFOpLambda)      (None, 320170, 1)    0           ['tf.__operators__.add_1[0][0]'] 
                                                                                                  
 tf.math.multiply (TFOpLambda)  (None, 320170, 1)    0           ['tf.reshape_8[0][0]']           
                                                                                                  
 tf.__operators__.getitem_4 (Sl  (None, 160085, 1)   0           ['tf.math.multiply[0][0]']       
 icingOpLambda)                                                                                   
                                                                                                  
 tf.reshape_9 (TFOpLambda)      (None, 160085, 1)    0           ['tf.__operators__.getitem_4[0][0
                                                                 ]']                              
                                                                                                  
 tf.compat.v1.pad_2 (TFOpLambda  (None, 160087, 1)   0           ['tf.reshape_9[0][0]']           
 )                                                                                                
                                                                                                  
 tf.compat.v1.nn.conv1d_3 (TFOp  (None, 160087, 1)   0           ['tf.compat.v1.pad_2[0][0]']     
 Lambda)                                                                                          
                                                                                                  
 tf.__operators__.getitem_5 (Sl  (None, 160085, 1)   0           ['tf.compat.v1.nn.conv1d_3[0][0]'
 icingOpLambda)                                                  ]                                
                                                                                                  
 tf.__operators__.getitem_3 (Sl  (None, 160085, 1)   0           ['tf.math.multiply[0][0]']       
 icingOpLambda)                                                                                   
                                                                                                  
 tf.reshape_10 (TFOpLambda)     (None, 160085, 1)    0           ['tf.__operators__.getitem_5[0][0
                                                                 ]']                              
                                                                                                  
 tf.__operators__.add_2 (TFOpLa  (None, 160085, 1)   0           ['tf.__operators__.getitem_3[0][0
 mbda)                                                           ]',                              
                                                                  'tf.reshape_10[0][0]']          
                                                                                                  
 tf.reshape_11 (TFOpLambda)     (None, 160085, 1)    0           ['tf.__operators__.add_2[0][0]'] 
                                                                                                  
 tf.math.multiply_1 (TFOpLambda  (None, 160085, 1)   0           ['tf.reshape_11[0][0]']          
 )                                                                                                
                                                                                                  
 tf.__operators__.getitem_6 (Sl  (None, 160000, 1)   0           ['tf.math.multiply_1[0][0]']     
 icingOpLambda)                                                                                   
                                                                                                  
 tf.math.multiply_2 (TFOpLambda  (None, 160000, 1)   0           ['tf.__operators__.getitem_6[0][0
 )                                                               ]',                              
                                                                  'tf.math.reduce_std[0][0]']     
                                                                                                  
==================================================================================================
Total params: 33,525,377
Trainable params: 33,525,377
Non-trainable params: 0
__________________________________________________________________________________________________
None
Created a new model
Len  {'clean': <tf.Tensor 'ParseExample/ParseExampleV2:0' shape=(16, 160000) dtype=float32>, 'noisy': <tf.Tensor 'ParseExample/ParseExampleV2:1' shape=(16, 160000) dtype=float32>}
Epoch 1/10
 1/10 [==>...........................] - ETA: 1:37 - loss: 0.0352 2/10 [=====>........................] - ETA: 5s - loss: 0.0325   3/10 [========>.....................] - ETA: 4s - loss: 0.0347 4/10 [===========>..................] - ETA: 4s - loss: 0.0337 5/10 [==============>...............] - ETA: 3s - loss: 0.0345 6/10 [=================>............] - ETA: 2s - loss: 0.0334 7/10 [====================>.........] - ETA: 2s - loss: 0.0332 8/10 [=======================>......] - ETA: 1s - loss: 0.0336 9/10 [==========================>...] - ETA: 0s - loss: 0.032910/10 [==============================] - ETA: 0s - loss: 0.032410/10 [==============================] - 21s 1s/step - loss: 0.0324 - val_loss: 0.0305
Epoch 2/10
 1/10 [==>...........................] - ETA: 6s - loss: 0.0363 2/10 [=====>........................] - ETA: 5s - loss: 0.0364 3/10 [========>.....................] - ETA: 4s - loss: 0.0373 4/10 [===========>..................] - ETA: 4s - loss: 0.0342 5/10 [==============>...............] - ETA: 3s - loss: 0.0341 6/10 [=================>............] - ETA: 2s - loss: 0.0335 7/10 [====================>.........] - ETA: 2s - loss: 0.0340 8/10 [=======================>......] - ETA: 1s - loss: 0.0335 9/10 [==========================>...] - ETA: 0s - loss: 0.033410/10 [==============================] - ETA: 0s - loss: 0.033310/10 [==============================] - 9s 940ms/step - loss: 0.0333 - val_loss: 0.0337
Epoch 3/10
 1/10 [==>...........................] - ETA: 6s - loss: 0.0242 2/10 [=====>........................] - ETA: 5s - loss: 0.0239 3/10 [========>.....................] - ETA: 4s - loss: 0.0269 4/10 [===========>..................] - ETA: 4s - loss: 0.0289 5/10 [==============>...............] - ETA: 3s - loss: 0.0286 6/10 [=================>............] - ETA: 2s - loss: 0.0290 7/10 [====================>.........] - ETA: 2s - loss: 0.0288 8/10 [=======================>......] - ETA: 1s - loss: 0.0283 9/10 [==========================>...] - ETA: 0s - loss: 0.028310/10 [==============================] - ETA: 0s - loss: 0.028510/10 [==============================] - 9s 935ms/step - loss: 0.0285 - val_loss: 0.0278
Epoch 4/10
 1/10 [==>...........................] - ETA: 6s - loss: 0.0255 2/10 [=====>........................] - ETA: 5s - loss: 0.0256 3/10 [========>.....................] - ETA: 4s - loss: 0.0254 4/10 [===========>..................] - ETA: 4s - loss: 0.0233 5/10 [==============>...............] - ETA: 3s - loss: 0.0243 6/10 [=================>............] - ETA: 2s - loss: 0.0253 7/10 [====================>.........] - ETA: 2s - loss: 0.0259 8/10 [=======================>......] - ETA: 1s - loss: 0.0255 9/10 [==========================>...] - ETA: 0s - loss: 0.025710/10 [==============================] - ETA: 0s - loss: 0.026310/10 [==============================] - 9s 930ms/step - loss: 0.0263 - val_loss: 0.0222
Epoch 5/10
 1/10 [==>...........................] - ETA: 6s - loss: 0.0205 2/10 [=====>........................] - ETA: 5s - loss: 0.0214 3/10 [========>.....................] - ETA: 4s - loss: 0.0223 4/10 [===========>..................] - ETA: 4s - loss: 0.0213 5/10 [==============>...............] - ETA: 3s - loss: 0.0211 6/10 [=================>............] - ETA: 2s - loss: 0.0195 7/10 [====================>.........] - ETA: 2s - loss: 0.0183 8/10 [=======================>......] - ETA: 1s - loss: 0.0173 9/10 [==========================>...] - ETA: 0s - loss: 0.016610/10 [==============================] - ETA: 0s - loss: 0.016610/10 [==============================] - 9s 943ms/step - loss: 0.0166 - val_loss: 0.0139
Epoch 6/10
 1/10 [==>...........................] - ETA: 6s - loss: 0.0114Batch size 16
Number of GPUs we have: 2
Len  {'clean': <tf.Tensor 'ParseExample/ParseExampleV2:0' shape=(16, 160000) dtype=float32>, 'noisy': <tf.Tensor 'ParseExample/ParseExampleV2:1' shape=(16, 160000) dtype=float32>}
Model: "demucs"
__________________________________________________________________________________________________
 Layer (type)                   Output Shape         Param #     Connected to                     
==================================================================================================
 input_layer (InputLayer)       [(None, 160000, 1)]  0           []                               
                                                                                                  
 tf.math.reduce_std (TFOpLambda  (None, 1, 1)        0           ['input_layer[0][0]']            
 )                                                                                                
                                                                                                  
 tf.__operators__.add (TFOpLamb  (None, 1, 1)        0           ['tf.math.reduce_std[0][0]']     
 da)                                                                                              
                                                                                                  
 tf.math.truediv (TFOpLambda)   (None, 160000, 1)    0           ['input_layer[0][0]',            
                                                                  'tf.__operators__.add[0][0]']   
                                                                                                  
 tf.compat.v1.pad (TFOpLambda)  (None, 160085, 1)    0           ['tf.math.truediv[0][0]']        
                                                                                                  
 tf.reshape (TFOpLambda)        (None, 160085, 1)    0           ['tf.compat.v1.pad[0][0]']       
                                                                                                  
 tf.compat.v1.nn.conv1d (TFOpLa  (None, 160085, 1)   0           ['tf.reshape[0][0]']             
 mbda)                                                                                            
                                                                                                  
 tf.reshape_1 (TFOpLambda)      (None, 160085, 1)    0           ['tf.compat.v1.nn.conv1d[0][0]'] 
                                                                                                  
 tf.stack (TFOpLambda)          (None, 160085, 2, 1  0           ['tf.compat.v1.pad[0][0]',       
                                )                                 'tf.reshape_1[0][0]']           
                                                                                                  
 tf.reshape_2 (TFOpLambda)      (None, 320170, 1)    0           ['tf.stack[0][0]']               
                                                                                                  
 tf.reshape_3 (TFOpLambda)      (None, 320170, 1)    0           ['tf.reshape_2[0][0]']           
                                                                                                  
 tf.compat.v1.nn.conv1d_1 (TFOp  (None, 320170, 1)   0           ['tf.reshape_3[0][0]']           
 Lambda)                                                                                          
                                                                                                  
 tf.reshape_4 (TFOpLambda)      (None, 320170, 1)    0           ['tf.compat.v1.nn.conv1d_1[0][0]'
                                                                 ]                                
                                                                                                  
 tf.stack_1 (TFOpLambda)        (None, 320170, 2, 1  0           ['tf.reshape_2[0][0]',           
                                )                                 'tf.reshape_4[0][0]']           
                                                                                                  
 tf.reshape_5 (TFOpLambda)      (None, 640340, 1)    0           ['tf.stack_1[0][0]']             
                                                                                                  
 encode_0 (Sequential)          (None, 160084, 64)   8896        ['tf.reshape_5[0][0]']           
                                                                                                  
 encode_1 (Sequential)          (None, 40020, 128)   98688       ['encode_0[0][0]']               
                                                                                                  
 encode_2 (Sequential)          (None, 10004, 256)   393984      ['encode_1[0][0]']               
                                                                                                  
 encode_3 (Sequential)          (None, 2500, 512)    1574400     ['encode_2[0][0]']               
                                                                                                  
 encode_4 (Sequential)          (None, 624, 1024)    6294528     ['encode_3[0][0]']               
                                                                                                  
 sequential (Sequential)        (None, 624, 1024)    16785408    ['encode_4[0][0]']               
                                                                                                  
 tf.identity_4 (TFOpLambda)     (None, 624, 1024)    0           ['encode_4[0][0]']               
                                                                                                  
 tf.math.add (TFOpLambda)       (None, 624, 1024)    0           ['sequential[0][0]',             
                                                                  'tf.identity_4[0][0]']          
                                                                                                  
 decode_4 (Sequential)          (None, 2500, 512)    6294016     ['tf.math.add[0][0]']            
                                                                                                  
 tf.identity_3 (TFOpLambda)     (None, 2500, 512)    0           ['encode_3[0][0]']               
                                                                                                  
 tf.math.add_1 (TFOpLambda)     (None, 2500, 512)    0           ['decode_4[0][0]',               
                                                                  'tf.identity_3[0][0]']          
                                                                                                  
 decode_3 (Sequential)          (None, 10004, 256)   1574144     ['tf.math.add_1[0][0]']          
                                                                                                  
 tf.identity_2 (TFOpLambda)     (None, 10004, 256)   0           ['encode_2[0][0]']               
                                                                                                  
 tf.math.add_2 (TFOpLambda)     (None, 10004, 256)   0           ['decode_3[0][0]',               
                                                                  'tf.identity_2[0][0]']          
                                                                                                  
 decode_2 (Sequential)          (None, 40020, 128)   393856      ['tf.math.add_2[0][0]']          
                                                                                                  
 tf.identity_1 (TFOpLambda)     (None, 40020, 128)   0           ['encode_1[0][0]']               
                                                                                                  
 tf.math.add_3 (TFOpLambda)     (None, 40020, 128)   0           ['decode_2[0][0]',               
                                                                  'tf.identity_1[0][0]']          
                                                                                                  
 decode_1 (Sequential)          (None, 160084, 64)   98624       ['tf.math.add_3[0][0]']          
                                                                                                  
 tf.identity (TFOpLambda)       (None, 160084, 64)   0           ['encode_0[0][0]']               
                                                                                                  
 tf.math.add_4 (TFOpLambda)     (None, 160084, 64)   0           ['decode_1[0][0]',               
                                                                  'tf.identity[0][0]']            
                                                                                                  
 decode_0 (Sequential)          (None, 640340, 1)    8833        ['tf.math.add_4[0][0]']          
                                                                                                  
 tf.__operators__.getitem_1 (Sl  (None, 320170, 1)   0           ['decode_0[0][0]']               
 icingOpLambda)                                                                                   
                                                                                                  
 tf.reshape_6 (TFOpLambda)      (None, 320170, 1)    0           ['tf.__operators__.getitem_1[0][0
                                                                 ]']                              
                                                                                                  
 tf.compat.v1.pad_1 (TFOpLambda  (None, 320172, 1)   0           ['tf.reshape_6[0][0]']           
 )                                                                                                
                                                                                                  
 tf.compat.v1.nn.conv1d_2 (TFOp  (None, 320172, 1)   0           ['tf.compat.v1.pad_1[0][0]']     
 Lambda)                                                                                          
                                                                                                  
 tf.__operators__.getitem_2 (Sl  (None, 320170, 1)   0           ['tf.compat.v1.nn.conv1d_2[0][0]'
 icingOpLambda)                                                  ]                                
                                                                                                  
 tf.__operators__.getitem (Slic  (None, 320170, 1)   0           ['decode_0[0][0]']               
 ingOpLambda)                                                                                     
                                                                                                  
 tf.reshape_7 (TFOpLambda)      (None, 320170, 1)    0           ['tf.__operators__.getitem_2[0][0
                                                                 ]']                              
                                                                                                  
 tf.__operators__.add_1 (TFOpLa  (None, 320170, 1)   0           ['tf.__operators__.getitem[0][0]'
 mbda)                                                           , 'tf.reshape_7[0][0]']          
                                                                                                  
 tf.reshape_8 (TFOpLambda)      (None, 320170, 1)    0           ['tf.__operators__.add_1[0][0]'] 
                                                                                                  
 tf.math.multiply (TFOpLambda)  (None, 320170, 1)    0           ['tf.reshape_8[0][0]']           
                                                                                                  
 tf.__operators__.getitem_4 (Sl  (None, 160085, 1)   0           ['tf.math.multiply[0][0]']       
 icingOpLambda)                                                                                   
                                                                                                  
 tf.reshape_9 (TFOpLambda)      (None, 160085, 1)    0           ['tf.__operators__.getitem_4[0][0
                                                                 ]']                              
                                                                                                  
 tf.compat.v1.pad_2 (TFOpLambda  (None, 160087, 1)   0           ['tf.reshape_9[0][0]']           
 )                                                                                                
                                                                                                  
 tf.compat.v1.nn.conv1d_3 (TFOp  (None, 160087, 1)   0           ['tf.compat.v1.pad_2[0][0]']     
 Lambda)                                                                                          
                                                                                                  
 tf.__operators__.getitem_5 (Sl  (None, 160085, 1)   0           ['tf.compat.v1.nn.conv1d_3[0][0]'
 icingOpLambda)                                                  ]                                
                                                                                                  
 tf.__operators__.getitem_3 (Sl  (None, 160085, 1)   0           ['tf.math.multiply[0][0]']       
 icingOpLambda)                                                                                   
                                                                                                  
 tf.reshape_10 (TFOpLambda)     (None, 160085, 1)    0           ['tf.__operators__.getitem_5[0][0
                                                                 ]']                              
                                                                                                  
 tf.__operators__.add_2 (TFOpLa  (None, 160085, 1)   0           ['tf.__operators__.getitem_3[0][0
 mbda)                                                           ]',                              
                                                                  'tf.reshape_10[0][0]']          
                                                                                                  
 tf.reshape_11 (TFOpLambda)     (None, 160085, 1)    0           ['tf.__operators__.add_2[0][0]'] 
                                                                                                  
 tf.math.multiply_1 (TFOpLambda  (None, 160085, 1)   0           ['tf.reshape_11[0][0]']          
 )                                                                                                
                                                                                                  
 tf.__operators__.getitem_6 (Sl  (None, 160000, 1)   0           ['tf.math.multiply_1[0][0]']     
 icingOpLambda)                                                                                   
                                                                                                  
 tf.math.multiply_2 (TFOpLambda  (None, 160000, 1)   0           ['tf.__operators__.getitem_6[0][0
 )                                                               ]',                              
                                                                  'tf.math.reduce_std[0][0]']     
                                                                                                  
==================================================================================================
Total params: 33,525,377
Trainable params: 33,525,377
Non-trainable params: 0
__________________________________________________________________________________________________
None
Created a new model
Restoring from /media/inverseai/432e68df-5f7f-44a3-ac5b-f984da69470d/inverseai/train/noise_reducer_16k_last/checkpoints/checkpoint_epoch-005_loss-0.016596.h5
Len  {'clean': <tf.Tensor 'ParseExample/ParseExampleV2:0' shape=(16, 160000) dtype=float32>, 'noisy': <tf.Tensor 'ParseExample/ParseExampleV2:1' shape=(16, 160000) dtype=float32>}
Epoch 1/10
 1/10 [==>...........................] - ETA: 3:18 - loss: 0.0160 2/10 [=====>........................] - ETA: 12s - loss: 0.0150  3/10 [========>.....................] - ETA: 10s - loss: 0.0142 4/10 [===========>..................] - ETA: 8s - loss: 0.0129  5/10 [==============>...............] - ETA: 6s - loss: 0.0130 6/10 [=================>............] - ETA: 4s - loss: 0.0130 7/10 [====================>.........] - ETA: 3s - loss: 0.0126 8/10 [=======================>......] - ETA: 2s - loss: 0.0130 9/10 [==========================>...] - ETA: 1s - loss: 0.013010/10 [==============================] - ETA: 0s - loss: 0.012610/10 [==============================] - 36s 1s/step - loss: 0.0126 - val_loss: 0.0109
Epoch 2/10
 1/10 [==>...........................] - ETA: 7s - loss: 0.0167 2/10 [=====>........................] - ETA: 6s - loss: 0.0132 3/10 [========>.....................] - ETA: 5s - loss: 0.0116 4/10 [===========>..................] - ETA: 5s - loss: 0.0111 5/10 [==============>...............] - ETA: 4s - loss: 0.0118 6/10 [=================>............] - ETA: 3s - loss: 0.0115 7/10 [====================>.........] - ETA: 2s - loss: 0.0118 8/10 [=======================>......] - ETA: 1s - loss: 0.0124 9/10 [==========================>...] - ETA: 0s - loss: 0.012210/10 [==============================] - ETA: 0s - loss: 0.011810/10 [==============================] - 11s 1s/step - loss: 0.0118 - val_loss: 0.0104
Epoch 3/10
 1/10 [==>...........................] - ETA: 8s - loss: 0.0126 2/10 [=====>........................] - ETA: 6s - loss: 0.0119 3/10 [========>.....................] - ETA: 5s - loss: 0.0142 4/10 [===========>..................] - ETA: 5s - loss: 0.0124 5/10 [==============>...............] - ETA: 4s - loss: 0.0121 6/10 [=================>............] - ETA: 3s - loss: 0.0115 7/10 [====================>.........] - ETA: 2s - loss: 0.0119 8/10 [=======================>......] - ETA: 1s - loss: 0.0116 9/10 [==========================>...] - ETA: 0s - loss: 0.012210/10 [==============================] - ETA: 0s - loss: 0.011910/10 [==============================] - 11s 1s/step - loss: 0.0119 - val_loss: 0.0104
Epoch 4/10
 1/10 [==>...........................] - ETA: 6s - loss: 0.0091 2/10 [=====>........................] - ETA: 6s - loss: 0.0078 3/10 [========>.....................] - ETA: 5s - loss: 0.0104 4/10 [===========>..................] - ETA: 5s - loss: 0.0091 5/10 [==============>...............] - ETA: 4s - loss: 0.0109 6/10 [=================>............] - ETA: 3s - loss: 0.0104 7/10 [====================>.........] - ETA: 2s - loss: 0.0106 8/10 [=======================>......] - ETA: 1s - loss: 0.0105 9/10 [==========================>...] - ETA: 0s - loss: 0.010610/10 [==============================] - ETA: 0s - loss: 0.010910/10 [==============================] - 11s 1s/step - loss: 0.0109 - val_loss: 0.0098
Epoch 5/10
 1/10 [==>...........................] - ETA: 7s - loss: 0.0087 2/10 [=====>........................] - ETA: 6s - loss: 0.0115 3/10 [========>.....................] - ETA: 5s - loss: 0.0114 4/10 [===========>..................] - ETA: 4s - loss: 0.0116 5/10 [==============>...............] - ETA: 4s - loss: 0.0111 6/10 [=================>............] - ETA: 3s - loss: 0.0115 7/10 [====================>.........] - ETA: 2s - loss: 0.0114 8/10 [=======================>......] - ETA: 1s - loss: 0.0108 9/10 [==========================>...] - ETA: 0s - loss: 0.010810/10 [==============================] - ETA: 0s - loss: 0.010610/10 [==============================] - 10s 1s/step - loss: 0.0106 - val_loss: 0.0101
Epoch 6/10
 1/10 [==>...........................] - ETA: 7s - loss: 0.0084 2/10 [=====>........................] - ETA: 6s - loss: 0.0099 3/10 [========>.....................] - ETA: 5s - loss: 0.0096 4/10 [===========>..................] - ETA: 4s - loss: 0.0105 5/10 [==============>...............] - ETA: 4s - loss: 0.0102 6/10 [=================>............] - ETA: 3s - loss: 0.0106 7/10 [====================>.........] - ETA: 2s - loss: 0.0103 8/10 [=======================>......] - ETA: 1s - loss: 0.0101 9/10 [==========================>...] - ETA: 0s - loss: 0.009910/10 [==============================] - ETA: 0s - loss: 0.010210/10 [==============================] - 10s 1s/step - loss: 0.0102 - val_loss: 0.0104
Epoch 7/10
 1/10 [==>...........................] - ETA: 7s - loss: 0.0097 2/10 [=====>........................] - ETA: 6s - loss: 0.0094 3/10 [========>.....................] - ETA: 5s - loss: 0.0092 4/10 [===========>..................] - ETA: 4s - loss: 0.0096 5/10 [==============>...............] - ETA: 4s - loss: 0.0092 6/10 [=================>............] - ETA: 3s - loss: 0.0099 7/10 [====================>.........] - ETA: 2s - loss: 0.0101 8/10 [=======================>......] - ETA: 1s - loss: 0.0103 9/10 [==========================>...] - ETA: 0s - loss: 0.009810/10 [==============================] - ETA: 0s - loss: 0.009510/10 [==============================] - 10s 1s/step - loss: 0.0095 - val_loss: 0.0100
Epoch 8/10
 1/10 [==>...........................] - ETA: 7s - loss: 0.0182 2/10 [=====>........................] - ETA: 6s - loss: 0.0152 3/10 [========>.....................] - ETA: 5s - loss: 0.0136 4/10 [===========>..................] - ETA: 4s - loss: 0.0120 5/10 [==============>...............] - ETA: 4s - loss: 0.0117 6/10 [=================>............] - ETA: 3s - loss: 0.0110 7/10 [====================>.........] - ETA: 2s - loss: 0.0110 8/10 [=======================>......] - ETA: 1s - loss: 0.0108 9/10 [==========================>...] - ETA: 0s - loss: 0.010310/10 [==============================] - ETA: 0s - loss: 0.010110/10 [==============================] - 10s 1s/step - loss: 0.0101 - val_loss: 0.0089
Epoch 9/10
 1/10 [==>...........................] - ETA: 7s - loss: 0.0083 2/10 [=====>........................] - ETA: 7s - loss: 0.0075 3/10 [========>.....................] - ETA: 6s - loss: 0.0088 4/10 [===========>..................] - ETA: 5s - loss: 0.0096 5/10 [==============>...............] - ETA: 4s - loss: 0.0103 6/10 [=================>............] - ETA: 3s - loss: 0.0096 7/10 [====================>.........] - ETA: 2s - loss: 0.0096 8/10 [=======================>......] - ETA: 1s - loss: 0.0095 9/10 [==========================>...] - ETA: 0s - loss: 0.009510/10 [==============================] - ETA: 0s - loss: 0.009310/10 [==============================] - 10s 1s/step - loss: 0.0093 - val_loss: 0.0090
Epoch 10/10
 1/10 [==>...........................] - ETA: 7s - loss: 0.0097 2/10 [=====>........................] - ETA: 6s - loss: 0.0102 3/10 [========>.....................] - ETA: 5s - loss: 0.0091 4/10 [===========>..................] - ETA: 5s - loss: 0.0093 5/10 [==============>...............] - ETA: 4s - loss: 0.0093 6/10 [=================>............] - ETA: 3s - loss: 0.0097 7/10 [====================>.........] - ETA: 2s - loss: 0.0095 8/10 [=======================>......] - ETA: 1s - loss: 0.0097 9/10 [==========================>...] - ETA: 0s - loss: 0.009410/10 [==============================] - ETA: 0s - loss: 0.009810/10 [==============================] - 11s 1s/step - loss: 0.0098 - val_loss: 0.0088
done


Batch size 16
Number of GPUs we have: 2
Len  {'clean': <tf.Tensor 'ParseExample/ParseExampleV2:0' shape=(16, 160000) dtype=float32>, 'noisy': <tf.Tensor 'ParseExample/ParseExampleV2:1' shape=(16, 160000) dtype=float32>}
Model: "demucs"
__________________________________________________________________________________________________
 Layer (type)                   Output Shape         Param #     Connected to                     
==================================================================================================
 input_layer (InputLayer)       [(None, 160000, 1)]  0           []                               
                                                                                                  
 tf.math.reduce_std (TFOpLambda  (None, 1, 1)        0           ['input_layer[0][0]']            
 )                                                                                                
                                                                                                  
 tf.__operators__.add (TFOpLamb  (None, 1, 1)        0           ['tf.math.reduce_std[0][0]']     
 da)                                                                                              
                                                                                                  
 tf.math.truediv (TFOpLambda)   (None, 160000, 1)    0           ['input_layer[0][0]',            
                                                                  'tf.__operators__.add[0][0]']   
                                                                                                  
 tf.compat.v1.pad (TFOpLambda)  (None, 160085, 1)    0           ['tf.math.truediv[0][0]']        
                                                                                                  
 tf.reshape (TFOpLambda)        (None, 160085, 1)    0           ['tf.compat.v1.pad[0][0]']       
                                                                                                  
 tf.compat.v1.nn.conv1d (TFOpLa  (None, 160085, 1)   0           ['tf.reshape[0][0]']             
 mbda)                                                                                            
                                                                                                  
 tf.reshape_1 (TFOpLambda)      (None, 160085, 1)    0           ['tf.compat.v1.nn.conv1d[0][0]'] 
                                                                                                  
 tf.stack (TFOpLambda)          (None, 160085, 2, 1  0           ['tf.compat.v1.pad[0][0]',       
                                )                                 'tf.reshape_1[0][0]']           
                                                                                                  
 tf.reshape_2 (TFOpLambda)      (None, 320170, 1)    0           ['tf.stack[0][0]']               
                                                                                                  
 tf.reshape_3 (TFOpLambda)      (None, 320170, 1)    0           ['tf.reshape_2[0][0]']           
                                                                                                  
 tf.compat.v1.nn.conv1d_1 (TFOp  (None, 320170, 1)   0           ['tf.reshape_3[0][0]']           
 Lambda)                                                                                          
                                                                                                  
 tf.reshape_4 (TFOpLambda)      (None, 320170, 1)    0           ['tf.compat.v1.nn.conv1d_1[0][0]'
                                                                 ]                                
                                                                                                  
 tf.stack_1 (TFOpLambda)        (None, 320170, 2, 1  0           ['tf.reshape_2[0][0]',           
                                )                                 'tf.reshape_4[0][0]']           
                                                                                                  
 tf.reshape_5 (TFOpLambda)      (None, 640340, 1)    0           ['tf.stack_1[0][0]']             
                                                                                                  
 encode_0 (Sequential)          (None, 160084, 64)   8896        ['tf.reshape_5[0][0]']           
                                                                                                  
 encode_1 (Sequential)          (None, 40020, 128)   98688       ['encode_0[0][0]']               
                                                                                                  
 encode_2 (Sequential)          (None, 10004, 256)   393984      ['encode_1[0][0]']               
                                                                                                  
 encode_3 (Sequential)          (None, 2500, 512)    1574400     ['encode_2[0][0]']               
                                                                                                  
 encode_4 (Sequential)          (None, 624, 1024)    6294528     ['encode_3[0][0]']               
                                                                                                  
 sequential (Sequential)        (None, 624, 1024)    16785408    ['encode_4[0][0]']               
                                                                                                  
 tf.identity_4 (TFOpLambda)     (None, 624, 1024)    0           ['encode_4[0][0]']               
                                                                                                  
 tf.math.add (TFOpLambda)       (None, 624, 1024)    0           ['sequential[0][0]',             
                                                                  'tf.identity_4[0][0]']          
                                                                                                  
 decode_4 (Sequential)          (None, 2500, 512)    6294016     ['tf.math.add[0][0]']            
                                                                                                  
 tf.identity_3 (TFOpLambda)     (None, 2500, 512)    0           ['encode_3[0][0]']               
                                                                                                  
 tf.math.add_1 (TFOpLambda)     (None, 2500, 512)    0           ['decode_4[0][0]',               
                                                                  'tf.identity_3[0][0]']          
                                                                                                  
 decode_3 (Sequential)          (None, 10004, 256)   1574144     ['tf.math.add_1[0][0]']          
                                                                                                  
 tf.identity_2 (TFOpLambda)     (None, 10004, 256)   0           ['encode_2[0][0]']               
                                                                                                  
 tf.math.add_2 (TFOpLambda)     (None, 10004, 256)   0           ['decode_3[0][0]',               
                                                                  'tf.identity_2[0][0]']          
                                                                                                  
 decode_2 (Sequential)          (None, 40020, 128)   393856      ['tf.math.add_2[0][0]']          
                                                                                                  
 tf.identity_1 (TFOpLambda)     (None, 40020, 128)   0           ['encode_1[0][0]']               
                                                                                                  
 tf.math.add_3 (TFOpLambda)     (None, 40020, 128)   0           ['decode_2[0][0]',               
                                                                  'tf.identity_1[0][0]']          
                                                                                                  
 decode_1 (Sequential)          (None, 160084, 64)   98624       ['tf.math.add_3[0][0]']          
                                                                                                  
 tf.identity (TFOpLambda)       (None, 160084, 64)   0           ['encode_0[0][0]']               
                                                                                                  
 tf.math.add_4 (TFOpLambda)     (None, 160084, 64)   0           ['decode_1[0][0]',               
                                                                  'tf.identity[0][0]']            
                                                                                                  
 decode_0 (Sequential)          (None, 640340, 1)    8833        ['tf.math.add_4[0][0]']          
                                                                                                  
 tf.__operators__.getitem_1 (Sl  (None, 320170, 1)   0           ['decode_0[0][0]']               
 icingOpLambda)                                                                                   
                                                                                                  
 tf.reshape_6 (TFOpLambda)      (None, 320170, 1)    0           ['tf.__operators__.getitem_1[0][0
                                                                 ]']                              
                                                                                                  
 tf.compat.v1.pad_1 (TFOpLambda  (None, 320172, 1)   0           ['tf.reshape_6[0][0]']           
 )                                                                                                
                                                                                                  
 tf.compat.v1.nn.conv1d_2 (TFOp  (None, 320172, 1)   0           ['tf.compat.v1.pad_1[0][0]']     
 Lambda)                                                                                          
                                                                                                  
 tf.__operators__.getitem_2 (Sl  (None, 320170, 1)   0           ['tf.compat.v1.nn.conv1d_2[0][0]'
 icingOpLambda)                                                  ]                                
                                                                                                  
 tf.__operators__.getitem (Slic  (None, 320170, 1)   0           ['decode_0[0][0]']               
 ingOpLambda)                                                                                     
                                                                                                  
 tf.reshape_7 (TFOpLambda)      (None, 320170, 1)    0           ['tf.__operators__.getitem_2[0][0
                                                                 ]']                              
                                                                                                  
 tf.__operators__.add_1 (TFOpLa  (None, 320170, 1)   0           ['tf.__operators__.getitem[0][0]'
 mbda)                                                           , 'tf.reshape_7[0][0]']          
                                                                                                  
 tf.reshape_8 (TFOpLambda)      (None, 320170, 1)    0           ['tf.__operators__.add_1[0][0]'] 
                                                                                                  
 tf.math.multiply (TFOpLambda)  (None, 320170, 1)    0           ['tf.reshape_8[0][0]']           
                                                                                                  
 tf.__operators__.getitem_4 (Sl  (None, 160085, 1)   0           ['tf.math.multiply[0][0]']       
 icingOpLambda)                                                                                   
                                                                                                  
 tf.reshape_9 (TFOpLambda)      (None, 160085, 1)    0           ['tf.__operators__.getitem_4[0][0
                                                                 ]']                              
                                                                                                  
 tf.compat.v1.pad_2 (TFOpLambda  (None, 160087, 1)   0           ['tf.reshape_9[0][0]']           
 )                                                                                                
                                                                                                  
 tf.compat.v1.nn.conv1d_3 (TFOp  (None, 160087, 1)   0           ['tf.compat.v1.pad_2[0][0]']     
 Lambda)                                                                                          
                                                                                                  
 tf.__operators__.getitem_5 (Sl  (None, 160085, 1)   0           ['tf.compat.v1.nn.conv1d_3[0][0]'
 icingOpLambda)                                                  ]                                
                                                                                                  
 tf.__operators__.getitem_3 (Sl  (None, 160085, 1)   0           ['tf.math.multiply[0][0]']       
 icingOpLambda)                                                                                   
                                                                                                  
 tf.reshape_10 (TFOpLambda)     (None, 160085, 1)    0           ['tf.__operators__.getitem_5[0][0
                                                                 ]']                              
                                                                                                  
 tf.__operators__.add_2 (TFOpLa  (None, 160085, 1)   0           ['tf.__operators__.getitem_3[0][0
 mbda)                                                           ]',                              
                                                                  'tf.reshape_10[0][0]']          
                                                                                                  
 tf.reshape_11 (TFOpLambda)     (None, 160085, 1)    0           ['tf.__operators__.add_2[0][0]'] 
                                                                                                  
 tf.math.multiply_1 (TFOpLambda  (None, 160085, 1)   0           ['tf.reshape_11[0][0]']          
 )                                                                                                
                                                                                                  
 tf.__operators__.getitem_6 (Sl  (None, 160000, 1)   0           ['tf.math.multiply_1[0][0]']     
 icingOpLambda)                                                                                   
                                                                                                  
 tf.math.multiply_2 (TFOpLambda  (None, 160000, 1)   0           ['tf.__operators__.getitem_6[0][0
 )                                                               ]',                              
                                                                  'tf.math.reduce_std[0][0]']     
                                                                                                  
==================================================================================================
Total params: 33,525,377
Trainable params: 33,525,377
Non-trainable params: 0
__________________________________________________________________________________________________
Batch size 16
Number of GPUs we have: 2
Len  {'clean': <tf.Tensor 'ParseExample/ParseExampleV2:0' shape=(16, 160000) dtype=float32>, 'noisy': <tf.Tensor 'ParseExample/ParseExampleV2:1' shape=(16, 160000) dtype=float32>}
Model: "demucs"
__________________________________________________________________________________________________
 Layer (type)                   Output Shape         Param #     Connected to                     
==================================================================================================
 input_layer (InputLayer)       [(None, 160000, 1)]  0           []                               
                                                                                                  
 tf.math.reduce_std (TFOpLambda  (None, 1, 1)        0           ['input_layer[0][0]']            
 )                                                                                                
                                                                                                  
 tf.__operators__.add (TFOpLamb  (None, 1, 1)        0           ['tf.math.reduce_std[0][0]']     
 da)                                                                                              
                                                                                                  
 tf.math.truediv (TFOpLambda)   (None, 160000, 1)    0           ['input_layer[0][0]',            
                                                                  'tf.__operators__.add[0][0]']   
                                                                                                  
 tf.compat.v1.pad (TFOpLambda)  (None, 160085, 1)    0           ['tf.math.truediv[0][0]']        
                                                                                                  
 tf.reshape (TFOpLambda)        (None, 160085, 1)    0           ['tf.compat.v1.pad[0][0]']       
                                                                                                  
 tf.compat.v1.nn.conv1d (TFOpLa  (None, 160085, 1)   0           ['tf.reshape[0][0]']             
 mbda)                                                                                            
                                                                                                  
 tf.reshape_1 (TFOpLambda)      (None, 160085, 1)    0           ['tf.compat.v1.nn.conv1d[0][0]'] 
                                                                                                  
 tf.stack (TFOpLambda)          (None, 160085, 2, 1  0           ['tf.compat.v1.pad[0][0]',       
                                )                                 'tf.reshape_1[0][0]']           
                                                                                                  
 tf.reshape_2 (TFOpLambda)      (None, 320170, 1)    0           ['tf.stack[0][0]']               
                                                                                                  
 tf.reshape_3 (TFOpLambda)      (None, 320170, 1)    0           ['tf.reshape_2[0][0]']           
                                                                                                  
 tf.compat.v1.nn.conv1d_1 (TFOp  (None, 320170, 1)   0           ['tf.reshape_3[0][0]']           
 Lambda)                                                                                          
                                                                                                  
 tf.reshape_4 (TFOpLambda)      (None, 320170, 1)    0           ['tf.compat.v1.nn.conv1d_1[0][0]'
                                                                 ]                                
                                                                                                  
 tf.stack_1 (TFOpLambda)        (None, 320170, 2, 1  0           ['tf.reshape_2[0][0]',           
                                )                                 'tf.reshape_4[0][0]']           
                                                                                                  
 tf.reshape_5 (TFOpLambda)      (None, 640340, 1)    0           ['tf.stack_1[0][0]']             
                                                                                                  
 encode_0 (Sequential)          (None, 160084, 64)   8896        ['tf.reshape_5[0][0]']           
                                                                                                  
 encode_1 (Sequential)          (None, 40020, 128)   98688       ['encode_0[0][0]']               
                                                                                                  
 encode_2 (Sequential)          (None, 10004, 256)   393984      ['encode_1[0][0]']               
                                                                                                  
 encode_3 (Sequential)          (None, 2500, 512)    1574400     ['encode_2[0][0]']               
                                                                                                  
 encode_4 (Sequential)          (None, 624, 1024)    6294528     ['encode_3[0][0]']               
                                                                                                  
 sequential (Sequential)        (None, 624, 1024)    16785408    ['encode_4[0][0]']               
                                                                                                  
 tf.identity_4 (TFOpLambda)     (None, 624, 1024)    0           ['encode_4[0][0]']               
                                                                                                  
 tf.math.add (TFOpLambda)       (None, 624, 1024)    0           ['sequential[0][0]',             
                                                                  'tf.identity_4[0][0]']          
                                                                                                  
 decode_4 (Sequential)          (None, 2500, 512)    6294016     ['tf.math.add[0][0]']            
                                                                                                  
 tf.identity_3 (TFOpLambda)     (None, 2500, 512)    0           ['encode_3[0][0]']               
                                                                                                  
 tf.math.add_1 (TFOpLambda)     (None, 2500, 512)    0           ['decode_4[0][0]',               
                                                                  'tf.identity_3[0][0]']          
                                                                                                  
 decode_3 (Sequential)          (None, 10004, 256)   1574144     ['tf.math.add_1[0][0]']          
                                                                                                  
 tf.identity_2 (TFOpLambda)     (None, 10004, 256)   0           ['encode_2[0][0]']               
                                                                                                  
 tf.math.add_2 (TFOpLambda)     (None, 10004, 256)   0           ['decode_3[0][0]',               
                                                                  'tf.identity_2[0][0]']          
                                                                                                  
 decode_2 (Sequential)          (None, 40020, 128)   393856      ['tf.math.add_2[0][0]']          
                                                                                                  
 tf.identity_1 (TFOpLambda)     (None, 40020, 128)   0           ['encode_1[0][0]']               
                                                                                                  
 tf.math.add_3 (TFOpLambda)     (None, 40020, 128)   0           ['decode_2[0][0]',               
                                                                  'tf.identity_1[0][0]']          
                                                                                                  
 decode_1 (Sequential)          (None, 160084, 64)   98624       ['tf.math.add_3[0][0]']          
                                                                                                  
 tf.identity (TFOpLambda)       (None, 160084, 64)   0           ['encode_0[0][0]']               
                                                                                                  
 tf.math.add_4 (TFOpLambda)     (None, 160084, 64)   0           ['decode_1[0][0]',               
                                                                  'tf.identity[0][0]']            
                                                                                                  
 decode_0 (Sequential)          (None, 640340, 1)    8833        ['tf.math.add_4[0][0]']          
                                                                                                  
 tf.__operators__.getitem_1 (Sl  (None, 320170, 1)   0           ['decode_0[0][0]']               
 icingOpLambda)                                                                                   
                                                                                                  
 tf.reshape_6 (TFOpLambda)      (None, 320170, 1)    0           ['tf.__operators__.getitem_1[0][0
                                                                 ]']                              
                                                                                                  
 tf.compat.v1.pad_1 (TFOpLambda  (None, 320172, 1)   0           ['tf.reshape_6[0][0]']           
 )                                                                                                
                                                                                                  
 tf.compat.v1.nn.conv1d_2 (TFOp  (None, 320172, 1)   0           ['tf.compat.v1.pad_1[0][0]']     
 Lambda)                                                                                          
                                                                                                  
 tf.__operators__.getitem_2 (Sl  (None, 320170, 1)   0           ['tf.compat.v1.nn.conv1d_2[0][0]'
 icingOpLambda)                                                  ]                                
                                                                                                  
 tf.__operators__.getitem (Slic  (None, 320170, 1)   0           ['decode_0[0][0]']               
 ingOpLambda)                                                                                     
                                                                                                  
 tf.reshape_7 (TFOpLambda)      (None, 320170, 1)    0           ['tf.__operators__.getitem_2[0][0
                                                                 ]']                              
                                                                                                  
 tf.__operators__.add_1 (TFOpLa  (None, 320170, 1)   0           ['tf.__operators__.getitem[0][0]'
 mbda)                                                           , 'tf.reshape_7[0][0]']          
                                                                                                  
 tf.reshape_8 (TFOpLambda)      (None, 320170, 1)    0           ['tf.__operators__.add_1[0][0]'] 
                                                                                                  
 tf.math.multiply (TFOpLambda)  (None, 320170, 1)    0           ['tf.reshape_8[0][0]']           
                                                                                                  
 tf.__operators__.getitem_4 (Sl  (None, 160085, 1)   0           ['tf.math.multiply[0][0]']       
 icingOpLambda)                                                                                   
                                                                                                  
 tf.reshape_9 (TFOpLambda)      (None, 160085, 1)    0           ['tf.__operators__.getitem_4[0][0
                                                                 ]']                              
                                                                                                  
 tf.compat.v1.pad_2 (TFOpLambda  (None, 160087, 1)   0           ['tf.reshape_9[0][0]']           
 )                                                                                                
                                                                                                  
 tf.compat.v1.nn.conv1d_3 (TFOp  (None, 160087, 1)   0           ['tf.compat.v1.pad_2[0][0]']     
 Lambda)                                                                                          
                                                                                                  
 tf.__operators__.getitem_5 (Sl  (None, 160085, 1)   0           ['tf.compat.v1.nn.conv1d_3[0][0]'
 icingOpLambda)                                                  ]                                
                                                                                                  
 tf.__operators__.getitem_3 (Sl  (None, 160085, 1)   0           ['tf.math.multiply[0][0]']       
 icingOpLambda)                                                                                   
                                                                                                  
 tf.reshape_10 (TFOpLambda)     (None, 160085, 1)    0           ['tf.__operators__.getitem_5[0][0
                                                                 ]']                              
                                                                                                  
 tf.__operators__.add_2 (TFOpLa  (None, 160085, 1)   0           ['tf.__operators__.getitem_3[0][0
 mbda)                                                           ]',                              
                                                                  'tf.reshape_10[0][0]']          
                                                                                                  
 tf.reshape_11 (TFOpLambda)     (None, 160085, 1)    0           ['tf.__operators__.add_2[0][0]'] 
                                                                                                  
 tf.math.multiply_1 (TFOpLambda  (None, 160085, 1)   0           ['tf.reshape_11[0][0]']          
 )                                                                                                
                                                                                                  
 tf.__operators__.getitem_6 (Sl  (None, 160000, 1)   0           ['tf.math.multiply_1[0][0]']     
 icingOpLambda)                                                                                   
                                                                                                  
 tf.math.multiply_2 (TFOpLambda  (None, 160000, 1)   0           ['tf.__operators__.getitem_6[0][0
 )                                                               ]',                              
                                                                  'tf.math.reduce_std[0][0]']     
                                                                                                  
==================================================================================================
Total params: 33,525,377
Trainable params: 33,525,377
Non-trainable params: 0
__________________________________________________________________________________________________
None
Created a new model
Len  {'clean': <tf.Tensor 'ParseExample/ParseExampleV2:0' shape=(16, 160000) dtype=float32>, 'noisy': <tf.Tensor 'ParseExample/ParseExampleV2:1' shape=(16, 160000) dtype=float32>}
Epoch 1/10
Batch size 16
Number of GPUs we have: 2
Len  {'clean': <tf.Tensor 'ParseExample/ParseExampleV2:0' shape=(16, 160000) dtype=float32>, 'noisy': <tf.Tensor 'ParseExample/ParseExampleV2:1' shape=(16, 160000) dtype=float32>}
Model: "demucs"
__________________________________________________________________________________________________
 Layer (type)                   Output Shape         Param #     Connected to                     
==================================================================================================
 input_layer (InputLayer)       [(None, 160000, 1)]  0           []                               
                                                                                                  
 tf.math.reduce_std (TFOpLambda  (None, 1, 1)        0           ['input_layer[0][0]']            
 )                                                                                                
                                                                                                  
 tf.__operators__.add (TFOpLamb  (None, 1, 1)        0           ['tf.math.reduce_std[0][0]']     
 da)                                                                                              
                                                                                                  
 tf.math.truediv (TFOpLambda)   (None, 160000, 1)    0           ['input_layer[0][0]',            
                                                                  'tf.__operators__.add[0][0]']   
                                                                                                  
 tf.compat.v1.pad (TFOpLambda)  (None, 160085, 1)    0           ['tf.math.truediv[0][0]']        
                                                                                                  
 tf.reshape (TFOpLambda)        (None, 160085, 1)    0           ['tf.compat.v1.pad[0][0]']       
                                                                                                  
 tf.compat.v1.nn.conv1d (TFOpLa  (None, 160085, 1)   0           ['tf.reshape[0][0]']             
 mbda)                                                                                            
                                                                                                  
 tf.reshape_1 (TFOpLambda)      (None, 160085, 1)    0           ['tf.compat.v1.nn.conv1d[0][0]'] 
                                                                                                  
 tf.stack (TFOpLambda)          (None, 160085, 2, 1  0           ['tf.compat.v1.pad[0][0]',       
                                )                                 'tf.reshape_1[0][0]']           
                                                                                                  
 tf.reshape_2 (TFOpLambda)      (None, 320170, 1)    0           ['tf.stack[0][0]']               
                                                                                                  
 tf.reshape_3 (TFOpLambda)      (None, 320170, 1)    0           ['tf.reshape_2[0][0]']           
                                                                                                  
 tf.compat.v1.nn.conv1d_1 (TFOp  (None, 320170, 1)   0           ['tf.reshape_3[0][0]']           
 Lambda)                                                                                          
                                                                                                  
 tf.reshape_4 (TFOpLambda)      (None, 320170, 1)    0           ['tf.compat.v1.nn.conv1d_1[0][0]'
                                                                 ]                                
                                                                                                  
 tf.stack_1 (TFOpLambda)        (None, 320170, 2, 1  0           ['tf.reshape_2[0][0]',           
                                )                                 'tf.reshape_4[0][0]']           
                                                                                                  
 tf.reshape_5 (TFOpLambda)      (None, 640340, 1)    0           ['tf.stack_1[0][0]']             
                                                                                                  
 encode_0 (Sequential)          (None, 160084, 64)   8896        ['tf.reshape_5[0][0]']           
                                                                                                  
 encode_1 (Sequential)          (None, 40020, 128)   98688       ['encode_0[0][0]']               
                                                                                                  
 encode_2 (Sequential)          (None, 10004, 256)   393984      ['encode_1[0][0]']               
                                                                                                  
 encode_3 (Sequential)          (None, 2500, 512)    1574400     ['encode_2[0][0]']               
                                                                                                  
 encode_4 (Sequential)          (None, 624, 1024)    6294528     ['encode_3[0][0]']               
                                                                                                  
 sequential (Sequential)        (None, 624, 1024)    16785408    ['encode_4[0][0]']               
                                                                                                  
 tf.identity_4 (TFOpLambda)     (None, 624, 1024)    0           ['encode_4[0][0]']               
                                                                                                  
 tf.math.add (TFOpLambda)       (None, 624, 1024)    0           ['sequential[0][0]',             
                                                                  'tf.identity_4[0][0]']          
                                                                                                  
 decode_4 (Sequential)          (None, 2500, 512)    6294016     ['tf.math.add[0][0]']            
                                                                                                  
 tf.identity_3 (TFOpLambda)     (None, 2500, 512)    0           ['encode_3[0][0]']               
                                                                                                  
 tf.math.add_1 (TFOpLambda)     (None, 2500, 512)    0           ['decode_4[0][0]',               
                                                                  'tf.identity_3[0][0]']          
                                                                                                  
 decode_3 (Sequential)          (None, 10004, 256)   1574144     ['tf.math.add_1[0][0]']          
                                                                                                  
 tf.identity_2 (TFOpLambda)     (None, 10004, 256)   0           ['encode_2[0][0]']               
                                                                                                  
 tf.math.add_2 (TFOpLambda)     (None, 10004, 256)   0           ['decode_3[0][0]',               
                                                                  'tf.identity_2[0][0]']          
                                                                                                  
 decode_2 (Sequential)          (None, 40020, 128)   393856      ['tf.math.add_2[0][0]']          
                                                                                                  
 tf.identity_1 (TFOpLambda)     (None, 40020, 128)   0           ['encode_1[0][0]']               
                                                                                                  
 tf.math.add_3 (TFOpLambda)     (None, 40020, 128)   0           ['decode_2[0][0]',               
                                                                  'tf.identity_1[0][0]']          
                                                                                                  
 decode_1 (Sequential)          (None, 160084, 64)   98624       ['tf.math.add_3[0][0]']          
                                                                                                  
 tf.identity (TFOpLambda)       (None, 160084, 64)   0           ['encode_0[0][0]']               
                                                                                                  
 tf.math.add_4 (TFOpLambda)     (None, 160084, 64)   0           ['decode_1[0][0]',               
                                                                  'tf.identity[0][0]']            
                                                                                                  
 decode_0 (Sequential)          (None, 640340, 1)    8833        ['tf.math.add_4[0][0]']          
                                                                                                  
 tf.__operators__.getitem_1 (Sl  (None, 320170, 1)   0           ['decode_0[0][0]']               
 icingOpLambda)                                                                                   
                                                                                                  
 tf.reshape_6 (TFOpLambda)      (None, 320170, 1)    0           ['tf.__operators__.getitem_1[0][0
                                                                 ]']                              
                                                                                                  
 tf.compat.v1.pad_1 (TFOpLambda  (None, 320172, 1)   0           ['tf.reshape_6[0][0]']           
 )                                                                                                
                                                                                                  
 tf.compat.v1.nn.conv1d_2 (TFOp  (None, 320172, 1)   0           ['tf.compat.v1.pad_1[0][0]']     
 Lambda)                                                                                          
                                                                                                  
 tf.__operators__.getitem_2 (Sl  (None, 320170, 1)   0           ['tf.compat.v1.nn.conv1d_2[0][0]'
 icingOpLambda)                                                  ]                                
                                                                                                  
 tf.__operators__.getitem (Slic  (None, 320170, 1)   0           ['decode_0[0][0]']               
 ingOpLambda)                                                                                     
                                                                                                  
 tf.reshape_7 (TFOpLambda)      (None, 320170, 1)    0           ['tf.__operators__.getitem_2[0][0
                                                                 ]']                              
                                                                                                  
 tf.__operators__.add_1 (TFOpLa  (None, 320170, 1)   0           ['tf.__operators__.getitem[0][0]'
 mbda)                                                           , 'tf.reshape_7[0][0]']          
                                                                                                  
 tf.reshape_8 (TFOpLambda)      (None, 320170, 1)    0           ['tf.__operators__.add_1[0][0]'] 
                                                                                                  
 tf.math.multiply (TFOpLambda)  (None, 320170, 1)    0           ['tf.reshape_8[0][0]']           
                                                                                                  
 tf.__operators__.getitem_4 (Sl  (None, 160085, 1)   0           ['tf.math.multiply[0][0]']       
 icingOpLambda)                                                                                   
                                                                                                  
 tf.reshape_9 (TFOpLambda)      (None, 160085, 1)    0           ['tf.__operators__.getitem_4[0][0
                                                                 ]']                              
                                                                                                  
 tf.compat.v1.pad_2 (TFOpLambda  (None, 160087, 1)   0           ['tf.reshape_9[0][0]']           
 )                                                                                                
                                                                                                  
 tf.compat.v1.nn.conv1d_3 (TFOp  (None, 160087, 1)   0           ['tf.compat.v1.pad_2[0][0]']     
 Lambda)                                                                                          
                                                                                                  
 tf.__operators__.getitem_5 (Sl  (None, 160085, 1)   0           ['tf.compat.v1.nn.conv1d_3[0][0]'
 icingOpLambda)                                                  ]                                
                                                                                                  
 tf.__operators__.getitem_3 (Sl  (None, 160085, 1)   0           ['tf.math.multiply[0][0]']       
 icingOpLambda)                                                                                   
                                                                                                  
 tf.reshape_10 (TFOpLambda)     (None, 160085, 1)    0           ['tf.__operators__.getitem_5[0][0
                                                                 ]']                              
                                                                                                  
 tf.__operators__.add_2 (TFOpLa  (None, 160085, 1)   0           ['tf.__operators__.getitem_3[0][0
 mbda)                                                           ]',                              
                                                                  'tf.reshape_10[0][0]']          
                                                                                                  
 tf.reshape_11 (TFOpLambda)     (None, 160085, 1)    0           ['tf.__operators__.add_2[0][0]'] 
                                                                                                  
 tf.math.multiply_1 (TFOpLambda  (None, 160085, 1)   0           ['tf.reshape_11[0][0]']          
 )                                                                                                
                                                                                                  
 tf.__operators__.getitem_6 (Sl  (None, 160000, 1)   0           ['tf.math.multiply_1[0][0]']     
 icingOpLambda)                                                                                   
                                                                                                  
 tf.math.multiply_2 (TFOpLambda  (None, 160000, 1)   0           ['tf.__operators__.getitem_6[0][0
 )                                                               ]',                              
                                                                  'tf.math.reduce_std[0][0]']     
                                                                                                  
==================================================================================================
Total params: 33,525,377
Trainable params: 33,525,377
Non-trainable params: 0
__________________________________________________________________________________________________
None
Created a new model
Len  {'clean': <tf.Tensor 'ParseExample/ParseExampleV2:0' shape=(16, 160000) dtype=float32>, 'noisy': <tf.Tensor 'ParseExample/ParseExampleV2:1' shape=(16, 160000) dtype=float32>}
Epoch 1/10
Batch size 16
Number of GPUs we have: 2
Len  {'clean': <tf.Tensor 'ParseExample/ParseExampleV2:0' shape=(16, 160000) dtype=float32>, 'noisy': <tf.Tensor 'ParseExample/ParseExampleV2:1' shape=(16, 160000) dtype=float32>}
Model: "demucs"
__________________________________________________________________________________________________
 Layer (type)                   Output Shape         Param #     Connected to                     
==================================================================================================
 input_layer (InputLayer)       [(None, 160000, 1)]  0           []                               
                                                                                                  
 tf.math.reduce_std (TFOpLambda  (None, 1, 1)        0           ['input_layer[0][0]']            
 )                                                                                                
                                                                                                  
 tf.__operators__.add (TFOpLamb  (None, 1, 1)        0           ['tf.math.reduce_std[0][0]']     
 da)                                                                                              
                                                                                                  
 tf.math.truediv (TFOpLambda)   (None, 160000, 1)    0           ['input_layer[0][0]',            
                                                                  'tf.__operators__.add[0][0]']   
                                                                                                  
 tf.compat.v1.pad (TFOpLambda)  (None, 160085, 1)    0           ['tf.math.truediv[0][0]']        
                                                                                                  
 tf.reshape (TFOpLambda)        (None, 160085, 1)    0           ['tf.compat.v1.pad[0][0]']       
                                                                                                  
 tf.compat.v1.nn.conv1d (TFOpLa  (None, 160085, 1)   0           ['tf.reshape[0][0]']             
 mbda)                                                                                            
                                                                                                  
 tf.reshape_1 (TFOpLambda)      (None, 160085, 1)    0           ['tf.compat.v1.nn.conv1d[0][0]'] 
                                                                                                  
 tf.stack (TFOpLambda)          (None, 160085, 2, 1  0           ['tf.compat.v1.pad[0][0]',       
                                )                                 'tf.reshape_1[0][0]']           
                                                                                                  
 tf.reshape_2 (TFOpLambda)      (None, 320170, 1)    0           ['tf.stack[0][0]']               
                                                                                                  
 tf.reshape_3 (TFOpLambda)      (None, 320170, 1)    0           ['tf.reshape_2[0][0]']           
                                                                                                  
 tf.compat.v1.nn.conv1d_1 (TFOp  (None, 320170, 1)   0           ['tf.reshape_3[0][0]']           
 Lambda)                                                                                          
                                                                                                  
 tf.reshape_4 (TFOpLambda)      (None, 320170, 1)    0           ['tf.compat.v1.nn.conv1d_1[0][0]'
                                                                 ]                                
                                                                                                  
 tf.stack_1 (TFOpLambda)        (None, 320170, 2, 1  0           ['tf.reshape_2[0][0]',           
                                )                                 'tf.reshape_4[0][0]']           
                                                                                                  
 tf.reshape_5 (TFOpLambda)      (None, 640340, 1)    0           ['tf.stack_1[0][0]']             
                                                                                                  
 encode_0 (Sequential)          (None, 160084, 64)   8896        ['tf.reshape_5[0][0]']           
                                                                                                  
 encode_1 (Sequential)          (None, 40020, 128)   98688       ['encode_0[0][0]']               
                                                                                                  
 encode_2 (Sequential)          (None, 10004, 256)   393984      ['encode_1[0][0]']               
                                                                                                  
 encode_3 (Sequential)          (None, 2500, 512)    1574400     ['encode_2[0][0]']               
                                                                                                  
 encode_4 (Sequential)          (None, 624, 1024)    6294528     ['encode_3[0][0]']               
                                                                                                  
 sequential (Sequential)        (None, 624, 1024)    16785408    ['encode_4[0][0]']               
                                                                                                  
 tf.identity_4 (TFOpLambda)     (None, 624, 1024)    0           ['encode_4[0][0]']               
                                                                                                  
 tf.math.add (TFOpLambda)       (None, 624, 1024)    0           ['sequential[0][0]',             
                                                                  'tf.identity_4[0][0]']          
                                                                                                  
 decode_4 (Sequential)          (None, 2500, 512)    6294016     ['tf.math.add[0][0]']            
                                                                                                  
 tf.identity_3 (TFOpLambda)     (None, 2500, 512)    0           ['encode_3[0][0]']               
                                                                                                  
 tf.math.add_1 (TFOpLambda)     (None, 2500, 512)    0           ['decode_4[0][0]',               
                                                                  'tf.identity_3[0][0]']          
                                                                                                  
 decode_3 (Sequential)          (None, 10004, 256)   1574144     ['tf.math.add_1[0][0]']          
                                                                                                  
 tf.identity_2 (TFOpLambda)     (None, 10004, 256)   0           ['encode_2[0][0]']               
                                                                                                  
 tf.math.add_2 (TFOpLambda)     (None, 10004, 256)   0           ['decode_3[0][0]',               
                                                                  'tf.identity_2[0][0]']          
                                                                                                  
 decode_2 (Sequential)          (None, 40020, 128)   393856      ['tf.math.add_2[0][0]']          
                                                                                                  
 tf.identity_1 (TFOpLambda)     (None, 40020, 128)   0           ['encode_1[0][0]']               
                                                                                                  
 tf.math.add_3 (TFOpLambda)     (None, 40020, 128)   0           ['decode_2[0][0]',               
                                                                  'tf.identity_1[0][0]']          
                                                                                                  
 decode_1 (Sequential)          (None, 160084, 64)   98624       ['tf.math.add_3[0][0]']          
                                                                                                  
 tf.identity (TFOpLambda)       (None, 160084, 64)   0           ['encode_0[0][0]']               
                                                                                                  
 tf.math.add_4 (TFOpLambda)     (None, 160084, 64)   0           ['decode_1[0][0]',               
                                                                  'tf.identity[0][0]']            
                                                                                                  
 decode_0 (Sequential)          (None, 640340, 1)    8833        ['tf.math.add_4[0][0]']          
                                                                                                  
 tf.__operators__.getitem_1 (Sl  (None, 320170, 1)   0           ['decode_0[0][0]']               
 icingOpLambda)                                                                                   
                                                                                                  
 tf.reshape_6 (TFOpLambda)      (None, 320170, 1)    0           ['tf.__operators__.getitem_1[0][0
                                                                 ]']                              
                                                                                                  
 tf.compat.v1.pad_1 (TFOpLambda  (None, 320172, 1)   0           ['tf.reshape_6[0][0]']           
 )                                                                                                
                                                                                                  
 tf.compat.v1.nn.conv1d_2 (TFOp  (None, 320172, 1)   0           ['tf.compat.v1.pad_1[0][0]']     
 Lambda)                                                                                          
                                                                                                  
 tf.__operators__.getitem_2 (Sl  (None, 320170, 1)   0           ['tf.compat.v1.nn.conv1d_2[0][0]'
 icingOpLambda)                                                  ]                                
                                                                                                  
 tf.__operators__.getitem (Slic  (None, 320170, 1)   0           ['decode_0[0][0]']               
 ingOpLambda)                                                                                     
                                                                                                  
 tf.reshape_7 (TFOpLambda)      (None, 320170, 1)    0           ['tf.__operators__.getitem_2[0][0
                                                                 ]']                              
                                                                                                  
 tf.__operators__.add_1 (TFOpLa  (None, 320170, 1)   0           ['tf.__operators__.getitem[0][0]'
 mbda)                                                           , 'tf.reshape_7[0][0]']          
                                                                                                  
 tf.reshape_8 (TFOpLambda)      (None, 320170, 1)    0           ['tf.__operators__.add_1[0][0]'] 
                                                                                                  
 tf.math.multiply (TFOpLambda)  (None, 320170, 1)    0           ['tf.reshape_8[0][0]']           
                                                                                                  
 tf.__operators__.getitem_4 (Sl  (None, 160085, 1)   0           ['tf.math.multiply[0][0]']       
 icingOpLambda)                                                                                   
                                                                                                  
 tf.reshape_9 (TFOpLambda)      (None, 160085, 1)    0           ['tf.__operators__.getitem_4[0][0
                                                                 ]']                              
                                                                                                  
 tf.compat.v1.pad_2 (TFOpLambda  (None, 160087, 1)   0           ['tf.reshape_9[0][0]']           
 )                                                                                                
                                                                                                  
 tf.compat.v1.nn.conv1d_3 (TFOp  (None, 160087, 1)   0           ['tf.compat.v1.pad_2[0][0]']     
 Lambda)                                                                                          
                                                                                                  
 tf.__operators__.getitem_5 (Sl  (None, 160085, 1)   0           ['tf.compat.v1.nn.conv1d_3[0][0]'
 icingOpLambda)                                                  ]                                
                                                                                                  
 tf.__operators__.getitem_3 (Sl  (None, 160085, 1)   0           ['tf.math.multiply[0][0]']       
 icingOpLambda)                                                                                   
                                                                                                  
 tf.reshape_10 (TFOpLambda)     (None, 160085, 1)    0           ['tf.__operators__.getitem_5[0][0
                                                                 ]']                              
                                                                                                  
 tf.__operators__.add_2 (TFOpLa  (None, 160085, 1)   0           ['tf.__operators__.getitem_3[0][0
 mbda)                                                           ]',                              
                                                                  'tf.reshape_10[0][0]']          
                                                                                                  
 tf.reshape_11 (TFOpLambda)     (None, 160085, 1)    0           ['tf.__operators__.add_2[0][0]'] 
                                                                                                  
 tf.math.multiply_1 (TFOpLambda  (None, 160085, 1)   0           ['tf.reshape_11[0][0]']          
 )                                                                                                
                                                                                                  
 tf.__operators__.getitem_6 (Sl  (None, 160000, 1)   0           ['tf.math.multiply_1[0][0]']     
 icingOpLambda)                                                                                   
                                                                                                  
 tf.math.multiply_2 (TFOpLambda  (None, 160000, 1)   0           ['tf.__operators__.getitem_6[0][0
 )                                                               ]',                              
                                                                  'tf.math.reduce_std[0][0]']     
                                                                                                  
==================================================================================================
Total params: 33,525,377
Trainable params: 33,525,377
Non-trainable params: 0
__________________________________________________________________________________________________
None
Created a new model
Len  {'clean': <tf.Tensor 'ParseExample/ParseExampleV2:0' shape=(16, 160000) dtype=float32>, 'noisy': <tf.Tensor 'ParseExample/ParseExampleV2:1' shape=(16, 160000) dtype=float32>}
Epoch 1/10
  1/100 [..............................] - ETA: 37:22 - loss: 0.0301  2/100 [..............................] - ETA: 2:23 - loss: 0.0298   3/100 [..............................] - ETA: 2:14 - loss: 0.0328  4/100 [>.............................] - ETA: 2:13 - loss: 0.0338  5/100 [>.............................] - ETA: 2:12 - loss: 0.0340  6/100 [>.............................] - ETA: 2:14 - loss: 0.0343  7/100 [=>............................] - ETA: 2:12 - loss: 0.0363  8/100 [=>............................] - ETA: 2:10 - loss: 0.0355  9/100 [=>............................] - ETA: 2:09 - loss: 0.0356 10/100 [==>...........................] - ETA: 2:08 - loss: 0.0350 11/100 [==>...........................] - ETA: 2:07 - loss: 0.0353 12/100 [==>...........................] - ETA: 2:05 - loss: 0.0346 13/100 [==>...........................] - ETA: 2:04 - loss: 0.0341 14/100 [===>..........................] - ETA: 2:03 - loss: 0.0337 15/100 [===>..........................] - ETA: 2:01 - loss: 0.0331 16/100 [===>..........................] - ETA: 2:01 - loss: 0.0332 17/100 [====>.........................] - ETA: 2:00 - loss: 0.0328 18/100 [====>.........................] - ETA: 1:59 - loss: 0.0328 19/100 [====>.........................] - ETA: 1:57 - loss: 0.0334 20/100 [=====>........................] - ETA: 1:57 - loss: 0.0336 21/100 [=====>........................] - ETA: 1:56 - loss: 0.0334 22/100 [=====>........................] - ETA: 1:54 - loss: 0.0330 23/100 [=====>........................] - ETA: 1:51 - loss: 0.0326 24/100 [======>.......................] - ETA: 1:48 - loss: 0.0327 25/100 [======>.......................] - ETA: 1:45 - loss: 0.0323 26/100 [======>.......................] - ETA: 1:42 - loss: 0.0322 27/100 [=======>......................] - ETA: 1:40 - loss: 0.0324 28/100 [=======>......................] - ETA: 1:37 - loss: 0.0321 29/100 [=======>......................] - ETA: 1:35 - loss: 0.0321 30/100 [========>.....................] - ETA: 1:32 - loss: 0.0319 31/100 [========>.....................] - ETA: 1:30 - loss: 0.0318 32/100 [========>.....................] - ETA: 1:28 - loss: 0.0315 33/100 [========>.....................] - ETA: 1:26 - loss: 0.0316 34/100 [=========>....................] - ETA: 1:24 - loss: 0.0315 35/100 [=========>....................] - ETA: 1:22 - loss: 0.0312 36/100 [=========>....................] - ETA: 1:20 - loss: 0.0312 37/100 [==========>...................] - ETA: 1:18 - loss: 0.0310 38/100 [==========>...................] - ETA: 1:16 - loss: 0.0308 39/100 [==========>...................] - ETA: 1:15 - loss: 0.0306 40/100 [===========>..................] - ETA: 1:13 - loss: 0.0303 41/100 [===========>..................] - ETA: 1:11 - loss: 0.0302 42/100 [===========>..................] - ETA: 1:10 - loss: 0.0301 43/100 [===========>..................] - ETA: 1:08 - loss: 0.0301 44/100 [============>.................] - ETA: 1:06 - loss: 0.0299 45/100 [============>.................] - ETA: 1:05 - loss: 0.0297 46/100 [============>.................] - ETA: 1:03 - loss: 0.0297 47/100 [=============>................] - ETA: 1:02 - loss: 0.0297 48/100 [=============>................] - ETA: 1:00 - loss: 0.0298 49/100 [=============>................] - ETA: 59s - loss: 0.0296  50/100 [==============>...............] - ETA: 57s - loss: 0.0295 51/100 [==============>...............] - ETA: 56s - loss: 0.0296 52/100 [==============>...............] - ETA: 55s - loss: 0.0295 53/100 [==============>...............] - ETA: 53s - loss: 0.0295 54/100 [===============>..............] - ETA: 52s - loss: 0.0294 55/100 [===============>..............] - ETA: 50s - loss: 0.0293 56/100 [===============>..............] - ETA: 49s - loss: 0.0292 57/100 [================>.............] - ETA: 48s - loss: 0.0290 58/100 [================>.............] - ETA: 46s - loss: 0.0289 59/100 [================>.............] - ETA: 45s - loss: 0.0289 60/100 [=================>............] - ETA: 44s - loss: 0.0288 61/100 [=================>............] - ETA: 43s - loss: 0.0287 62/100 [=================>............] - ETA: 41s - loss: 0.0286 63/100 [=================>............] - ETA: 40s - loss: 0.0286 64/100 [==================>...........] - ETA: 39s - loss: 0.0286 65/100 [==================>...........] - ETA: 38s - loss: 0.0284 66/100 [==================>...........] - ETA: 37s - loss: 0.0284 67/100 [===================>..........] - ETA: 35s - loss: 0.0283 68/100 [===================>..........] - ETA: 34s - loss: 0.0282 69/100 [===================>..........] - ETA: 33s - loss: 0.0282 70/100 [====================>.........] - ETA: 32s - loss: 0.0287 71/100 [====================>.........] - ETA: 31s - loss: 0.0286 72/100 [====================>.........] - ETA: 30s - loss: 0.0286 73/100 [====================>.........] - ETA: 28s - loss: 0.0285 74/100 [=====================>........] - ETA: 27s - loss: 0.0285 75/100 [=====================>........] - ETA: 26s - loss: 0.0285 76/100 [=====================>........] - ETA: 25s - loss: 0.0285 77/100 [======================>.......] - ETA: 24s - loss: 0.0284 78/100 [======================>.......] - ETA: 23s - loss: 0.0283 79/100 [======================>.......] - ETA: 22s - loss: 0.0283 80/100 [=======================>......] - ETA: 21s - loss: 0.0284 81/100 [=======================>......] - ETA: 20s - loss: 0.0283 82/100 [=======================>......] - ETA: 19s - loss: 0.0283 83/100 [=======================>......] - ETA: 17s - loss: 0.0283 84/100 [========================>.....] - ETA: 16s - loss: 0.0282 85/100 [========================>.....] - ETA: 15s - loss: 0.0281 86/100 [========================>.....] - ETA: 14s - loss: 0.0280 87/100 [=========================>....] - ETA: 13s - loss: 0.0280 88/100 [=========================>....] - ETA: 12s - loss: 0.0282 89/100 [=========================>....] - ETA: 11s - loss: 0.0281 90/100 [==========================>...] - ETA: 10s - loss: 0.0281 91/100 [==========================>...] - ETA: 9s - loss: 0.0281  92/100 [==========================>...] - ETA: 8s - loss: 0.0281 93/100 [==========================>...] - ETA: 7s - loss: 0.0280 94/100 [===========================>..] - ETA: 6s - loss: 0.0280 95/100 [===========================>..] - ETA: 5s - loss: 0.0279 96/100 [===========================>..] - ETA: 4s - loss: 0.0278 97/100 [============================>.] - ETA: 3s - loss: 0.0278 98/100 [============================>.] - ETA: 2s - loss: 0.0279 99/100 [============================>.] - ETA: 1s - loss: 0.0278100/100 [==============================] - ETA: 0s - loss: 0.0277100/100 [==============================] - 145s 1s/step - loss: 0.0277 - val_loss: 0.0200
Epoch 2/10
  1/100 [..............................] - ETA: 1:30 - loss: 0.0275  2/100 [..............................] - ETA: 1:26 - loss: 0.0254  3/100 [..............................] - ETA: 1:29 - loss: 0.0246  4/100 [>.............................] - ETA: 1:26 - loss: 0.0254  5/100 [>.............................] - ETA: 1:24 - loss: 0.0246  6/100 [>.............................] - ETA: 1:24 - loss: 0.0246  7/100 [=>............................] - ETA: 1:23 - loss: 0.0246  8/100 [=>............................] - ETA: 1:22 - loss: 0.0242  9/100 [=>............................] - ETA: 1:22 - loss: 0.0247 10/100 [==>...........................] - ETA: 1:20 - loss: 0.0245 11/100 [==>...........................] - ETA: 1:19 - loss: 0.0250 12/100 [==>...........................] - ETA: 1:18 - loss: 0.0249 13/100 [==>...........................] - ETA: 1:18 - loss: 0.0246 14/100 [===>..........................] - ETA: 1:17 - loss: 0.0245 15/100 [===>..........................] - ETA: 1:16 - loss: 0.0244 16/100 [===>..........................] - ETA: 1:15 - loss: 0.0245 17/100 [====>.........................] - ETA: 1:14 - loss: 0.0243 18/100 [====>.........................] - ETA: 1:13 - loss: 0.0242 19/100 [====>.........................] - ETA: 1:12 - loss: 0.0244 20/100 [=====>........................] - ETA: 1:11 - loss: 0.0246 21/100 [=====>........................] - ETA: 1:10 - loss: 0.0244 22/100 [=====>........................] - ETA: 1:09 - loss: 0.0245 23/100 [=====>........................] - ETA: 1:09 - loss: 0.0245 24/100 [======>.......................] - ETA: 1:08 - loss: 0.0248 25/100 [======>.......................] - ETA: 1:07 - loss: 0.0246 26/100 [======>.......................] - ETA: 1:06 - loss: 0.0245 27/100 [=======>......................] - ETA: 1:05 - loss: 0.0244 28/100 [=======>......................] - ETA: 1:04 - loss: 0.0245 29/100 [=======>......................] - ETA: 1:03 - loss: 0.0243 30/100 [========>.....................] - ETA: 1:02 - loss: 0.0242 31/100 [========>.....................] - ETA: 1:01 - loss: 0.0242 32/100 [========>.....................] - ETA: 1:00 - loss: 0.0242 33/100 [========>.....................] - ETA: 59s - loss: 0.0241  34/100 [=========>....................] - ETA: 59s - loss: 0.0242 35/100 [=========>....................] - ETA: 58s - loss: 0.0241 36/100 [=========>....................] - ETA: 57s - loss: 0.0240 37/100 [==========>...................] - ETA: 56s - loss: 0.0240 38/100 [==========>...................] - ETA: 55s - loss: 0.0240 39/100 [==========>...................] - ETA: 54s - loss: 0.0239 40/100 [===========>..................] - ETA: 53s - loss: 0.0238 41/100 [===========>..................] - ETA: 53s - loss: 0.0239 42/100 [===========>..................] - ETA: 52s - loss: 0.0240 43/100 [===========>..................] - ETA: 51s - loss: 0.0239 44/100 [============>.................] - ETA: 50s - loss: 0.0240 45/100 [============>.................] - ETA: 49s - loss: 0.0240 46/100 [============>.................] - ETA: 48s - loss: 0.0238 47/100 [=============>................] - ETA: 47s - loss: 0.0238 48/100 [=============>................] - ETA: 46s - loss: 0.0237 49/100 [=============>................] - ETA: 45s - loss: 0.0237 50/100 [==============>...............] - ETA: 44s - loss: 0.0236 51/100 [==============>...............] - ETA: 44s - loss: 0.0235 52/100 [==============>...............] - ETA: 43s - loss: 0.0235 53/100 [==============>...............] - ETA: 42s - loss: 0.0235 54/100 [===============>..............] - ETA: 41s - loss: 0.0234 55/100 [===============>..............] - ETA: 40s - loss: 0.0234 56/100 [===============>..............] - ETA: 39s - loss: 0.0234 57/100 [================>.............] - ETA: 38s - loss: 0.0234 58/100 [================>.............] - ETA: 37s - loss: 0.0233 59/100 [================>.............] - ETA: 36s - loss: 0.0234 60/100 [=================>............] - ETA: 35s - loss: 0.0235 61/100 [=================>............] - ETA: 35s - loss: 0.0234 62/100 [=================>............] - ETA: 34s - loss: 0.0234 63/100 [=================>............] - ETA: 33s - loss: 0.0234 64/100 [==================>...........] - ETA: 32s - loss: 0.0233 65/100 [==================>...........] - ETA: 31s - loss: 0.0233 66/100 [==================>...........] - ETA: 30s - loss: 0.0233 67/100 [===================>..........] - ETA: 29s - loss: 0.0233 68/100 [===================>..........] - ETA: 28s - loss: 0.0233 69/100 [===================>..........] - ETA: 27s - loss: 0.0232 70/100 [====================>.........] - ETA: 26s - loss: 0.0233 71/100 [====================>.........] - ETA: 26s - loss: 0.0232 72/100 [====================>.........] - ETA: 25s - loss: 0.0231 73/100 [====================>.........] - ETA: 24s - loss: 0.0231 74/100 [=====================>........] - ETA: 23s - loss: 0.0231 75/100 [=====================>........] - ETA: 22s - loss: 0.0231 76/100 [=====================>........] - ETA: 21s - loss: 0.0231 77/100 [======================>.......] - ETA: 20s - loss: 0.0231 78/100 [======================>.......] - ETA: 19s - loss: 0.0231 79/100 [======================>.......] - ETA: 18s - loss: 0.0230 80/100 [=======================>......] - ETA: 17s - loss: 0.0230 81/100 [=======================>......] - ETA: 17s - loss: 0.0231 82/100 [=======================>......] - ETA: 16s - loss: 0.0230 83/100 [=======================>......] - ETA: 15s - loss: 0.0230 84/100 [========================>.....] - ETA: 14s - loss: 0.0229 85/100 [========================>.....] - ETA: 13s - loss: 0.0229 86/100 [========================>.....] - ETA: 12s - loss: 0.0229 87/100 [=========================>....] - ETA: 11s - loss: 0.0229 88/100 [=========================>....] - ETA: 10s - loss: 0.0229 89/100 [=========================>....] - ETA: 9s - loss: 0.0228  90/100 [==========================>...] - ETA: 8s - loss: 0.0228 91/100 [==========================>...] - ETA: 8s - loss: 0.0228 92/100 [==========================>...] - ETA: 7s - loss: 0.0229 93/100 [==========================>...] - ETA: 6s - loss: 0.0229 94/100 [===========================>..] - ETA: 5s - loss: 0.0229 95/100 [===========================>..] - ETA: 4s - loss: 0.0229 96/100 [===========================>..] - ETA: 3s - loss: 0.0229 97/100 [============================>.] - ETA: 2s - loss: 0.0229 98/100 [============================>.] - ETA: 1s - loss: 0.0230 99/100 [============================>.] - ETA: 0s - loss: 0.0230100/100 [==============================] - ETA: 0s - loss: 0.0230100/100 [==============================] - 110s 1s/step - loss: 0.0230 - val_loss: 0.0185
Epoch 3/10
  1/100 [..............................] - ETA: 1:32 - loss: 0.0251  2/100 [..............................] - ETA: 1:33 - loss: 0.0229  3/100 [..............................] - ETA: 1:31 - loss: 0.0228  4/100 [>.............................] - ETA: 1:28 - loss: 0.0218  5/100 [>.............................] - ETA: 1:27 - loss: 0.0229  6/100 [>.............................] - ETA: 1:26 - loss: 0.0220  7/100 [=>............................] - ETA: 1:25 - loss: 0.0221  8/100 [=>............................] - ETA: 1:23 - loss: 0.0221  9/100 [=>............................] - ETA: 1:21 - loss: 0.0219 10/100 [==>...........................] - ETA: 1:21 - loss: 0.0219 11/100 [==>...........................] - ETA: 1:20 - loss: 0.0222 12/100 [==>...........................] - ETA: 1:18 - loss: 0.0224 13/100 [==>...........................] - ETA: 1:18 - loss: 0.0223 14/100 [===>..........................] - ETA: 1:16 - loss: 0.0225 15/100 [===>..........................] - ETA: 1:16 - loss: 0.0228 16/100 [===>..........................] - ETA: 1:15 - loss: 0.0225 17/100 [====>.........................] - ETA: 1:14 - loss: 0.0225 18/100 [====>.........................] - ETA: 1:13 - loss: 0.0224 19/100 [====>.........................] - ETA: 1:12 - loss: 0.0222 20/100 [=====>........................] - ETA: 1:11 - loss: 0.0223 21/100 [=====>........................] - ETA: 1:10 - loss: 0.0224 22/100 [=====>........................] - ETA: 1:09 - loss: 0.0223 23/100 [=====>........................] - ETA: 1:08 - loss: 0.0222 24/100 [======>.......................] - ETA: 1:08 - loss: 0.0223 25/100 [======>.......................] - ETA: 1:07 - loss: 0.0223 26/100 [======>.......................] - ETA: 1:06 - loss: 0.0222 27/100 [=======>......................] - ETA: 1:05 - loss: 0.0224 28/100 [=======>......................] - ETA: 1:04 - loss: 0.0225 29/100 [=======>......................] - ETA: 1:03 - loss: 0.0225 30/100 [========>.....................] - ETA: 1:02 - loss: 0.0227 31/100 [========>.....................] - ETA: 1:01 - loss: 0.0226 32/100 [========>.....................] - ETA: 1:00 - loss: 0.0226 33/100 [========>.....................] - ETA: 59s - loss: 0.0225  34/100 [=========>....................] - ETA: 58s - loss: 0.0225 35/100 [=========>....................] - ETA: 58s - loss: 0.0224 36/100 [=========>....................] - ETA: 57s - loss: 0.0223 37/100 [==========>...................] - ETA: 56s - loss: 0.0223 38/100 [==========>...................] - ETA: 55s - loss: 0.0221 39/100 [==========>...................] - ETA: 54s - loss: 0.0220 40/100 [===========>..................] - ETA: 53s - loss: 0.0219 41/100 [===========>..................] - ETA: 52s - loss: 0.0218 42/100 [===========>..................] - ETA: 51s - loss: 0.0217 43/100 [===========>..................] - ETA: 51s - loss: 0.0216 44/100 [============>.................] - ETA: 50s - loss: 0.0215 45/100 [============>.................] - ETA: 49s - loss: 0.0214 46/100 [============>.................] - ETA: 48s - loss: 0.0214 47/100 [=============>................] - ETA: 47s - loss: 0.0214 48/100 [=============>................] - ETA: 46s - loss: 0.0213 49/100 [=============>................] - ETA: 45s - loss: 0.0213 50/100 [==============>...............] - ETA: 44s - loss: 0.0213 51/100 [==============>...............] - ETA: 43s - loss: 0.0213 52/100 [==============>...............] - ETA: 43s - loss: 0.0212 53/100 [==============>...............] - ETA: 42s - loss: 0.0213 54/100 [===============>..............] - ETA: 41s - loss: 0.0212 55/100 [===============>..............] - ETA: 40s - loss: 0.0211 56/100 [===============>..............] - ETA: 39s - loss: 0.0211 57/100 [================>.............] - ETA: 38s - loss: 0.0210 58/100 [================>.............] - ETA: 37s - loss: 0.0210 59/100 [================>.............] - ETA: 36s - loss: 0.0210 60/100 [=================>............] - ETA: 35s - loss: 0.0210 61/100 [=================>............] - ETA: 34s - loss: 0.0209 62/100 [=================>............] - ETA: 34s - loss: 0.0209 63/100 [=================>............] - ETA: 33s - loss: 0.0209 64/100 [==================>...........] - ETA: 32s - loss: 0.0209 65/100 [==================>...........] - ETA: 31s - loss: 0.0208 66/100 [==================>...........] - ETA: 30s - loss: 0.0209 67/100 [===================>..........] - ETA: 29s - loss: 0.0208 68/100 [===================>..........] - ETA: 28s - loss: 0.0207 69/100 [===================>..........] - ETA: 27s - loss: 0.0206 70/100 [====================>.........] - ETA: 27s - loss: 0.0206 71/100 [====================>.........] - ETA: 26s - loss: 0.0206 72/100 [====================>.........] - ETA: 25s - loss: 0.0206 73/100 [====================>.........] - ETA: 24s - loss: 0.0206 74/100 [=====================>........] - ETA: 23s - loss: 0.0205 75/100 [=====================>........] - ETA: 22s - loss: 0.0205 76/100 [=====================>........] - ETA: 21s - loss: 0.0205 77/100 [======================>.......] - ETA: 20s - loss: 0.0204 78/100 [======================>.......] - ETA: 19s - loss: 0.0204 79/100 [======================>.......] - ETA: 18s - loss: 0.0203 80/100 [=======================>......] - ETA: 18s - loss: 0.0203 81/100 [=======================>......] - ETA: 17s - loss: 0.0202 82/100 [=======================>......] - ETA: 16s - loss: 0.0201 83/100 [=======================>......] - ETA: 15s - loss: 0.0201 84/100 [========================>.....] - ETA: 14s - loss: 0.0201 85/100 [========================>.....] - ETA: 13s - loss: 0.0201 86/100 [========================>.....] - ETA: 12s - loss: 0.0201 87/100 [=========================>....] - ETA: 11s - loss: 0.0200 88/100 [=========================>....] - ETA: 10s - loss: 0.0200 89/100 [=========================>....] - ETA: 9s - loss: 0.0199  90/100 [==========================>...] - ETA: 8s - loss: 0.0199 91/100 [==========================>...] - ETA: 8s - loss: 0.0199 92/100 [==========================>...] - ETA: 7s - loss: 0.0199 93/100 [==========================>...] - ETA: 6s - loss: 0.0199 94/100 [===========================>..] - ETA: 5s - loss: 0.0199 95/100 [===========================>..] - ETA: 4s - loss: 0.0198 96/100 [===========================>..] - ETA: 3s - loss: 0.0198 97/100 [============================>.] - ETA: 2s - loss: 0.0198 98/100 [============================>.] - ETA: 1s - loss: 0.0197 99/100 [============================>.] - ETA: 0s - loss: 0.0197100/100 [==============================] - ETA: 0s - loss: 0.0197100/100 [==============================] - 110s 1s/step - loss: 0.0197 - val_loss: 0.0168
Epoch 4/10
  1/100 [..............................] - ETA: 1:25 - loss: 0.0141  2/100 [..............................] - ETA: 1:29 - loss: 0.0170  3/100 [..............................] - ETA: 1:28 - loss: 0.0164Batch size 16
Number of GPUs we have: 2
Len  {'clean': <tf.Tensor 'ParseExample/ParseExampleV2:0' shape=(16, 160000) dtype=float32>, 'noisy': <tf.Tensor 'ParseExample/ParseExampleV2:1' shape=(16, 160000) dtype=float32>}
Batch size 16
Number of GPUs we have: 2
Len  {'clean': <tf.Tensor 'ParseExample/ParseExampleV2:0' shape=(16, 160000) dtype=float32>, 'noisy': <tf.Tensor 'ParseExample/ParseExampleV2:1' shape=(16, 160000) dtype=float32>}
Model: "demucs"
__________________________________________________________________________________________________
 Layer (type)                   Output Shape         Param #     Connected to                     
==================================================================================================
 input_layer (InputLayer)       [(None, 160000, 1)]  0           []                               
                                                                                                  
 tf.math.reduce_std (TFOpLambda  (None, 1, 1)        0           ['input_layer[0][0]']            
 )                                                                                                
                                                                                                  
 tf.__operators__.add (TFOpLamb  (None, 1, 1)        0           ['tf.math.reduce_std[0][0]']     
 da)                                                                                              
                                                                                                  
 tf.math.truediv (TFOpLambda)   (None, 160000, 1)    0           ['input_layer[0][0]',            
                                                                  'tf.__operators__.add[0][0]']   
                                                                                                  
 tf.compat.v1.pad (TFOpLambda)  (None, 160085, 1)    0           ['tf.math.truediv[0][0]']        
                                                                                                  
 tf.reshape (TFOpLambda)        (None, 160085, 1)    0           ['tf.compat.v1.pad[0][0]']       
                                                                                                  
 tf.compat.v1.nn.conv1d (TFOpLa  (None, 160085, 1)   0           ['tf.reshape[0][0]']             
 mbda)                                                                                            
                                                                                                  
 tf.reshape_1 (TFOpLambda)      (None, 160085, 1)    0           ['tf.compat.v1.nn.conv1d[0][0]'] 
                                                                                                  
 tf.stack (TFOpLambda)          (None, 160085, 2, 1  0           ['tf.compat.v1.pad[0][0]',       
                                )                                 'tf.reshape_1[0][0]']           
                                                                                                  
 tf.reshape_2 (TFOpLambda)      (None, 320170, 1)    0           ['tf.stack[0][0]']               
                                                                                                  
 tf.reshape_3 (TFOpLambda)      (None, 320170, 1)    0           ['tf.reshape_2[0][0]']           
                                                                                                  
 tf.compat.v1.nn.conv1d_1 (TFOp  (None, 320170, 1)   0           ['tf.reshape_3[0][0]']           
 Lambda)                                                                                          
                                                                                                  
 tf.reshape_4 (TFOpLambda)      (None, 320170, 1)    0           ['tf.compat.v1.nn.conv1d_1[0][0]'
                                                                 ]                                
                                                                                                  
 tf.stack_1 (TFOpLambda)        (None, 320170, 2, 1  0           ['tf.reshape_2[0][0]',           
                                )                                 'tf.reshape_4[0][0]']           
                                                                                                  
 tf.reshape_5 (TFOpLambda)      (None, 640340, 1)    0           ['tf.stack_1[0][0]']             
                                                                                                  
 encode_0 (Sequential)          (None, 160084, 64)   8896        ['tf.reshape_5[0][0]']           
                                                                                                  
 encode_1 (Sequential)          (None, 40020, 128)   98688       ['encode_0[0][0]']               
                                                                                                  
 encode_2 (Sequential)          (None, 10004, 256)   393984      ['encode_1[0][0]']               
                                                                                                  
 encode_3 (Sequential)          (None, 2500, 512)    1574400     ['encode_2[0][0]']               
                                                                                                  
 encode_4 (Sequential)          (None, 624, 1024)    6294528     ['encode_3[0][0]']               
                                                                                                  
 sequential (Sequential)        (None, 624, 1024)    16785408    ['encode_4[0][0]']               
                                                                                                  
 tf.identity_4 (TFOpLambda)     (None, 624, 1024)    0           ['encode_4[0][0]']               
                                                                                                  
 tf.math.add (TFOpLambda)       (None, 624, 1024)    0           ['sequential[0][0]',             
                                                                  'tf.identity_4[0][0]']          
                                                                                                  
 decode_4 (Sequential)          (None, 2500, 512)    6294016     ['tf.math.add[0][0]']            
                                                                                                  
 tf.identity_3 (TFOpLambda)     (None, 2500, 512)    0           ['encode_3[0][0]']               
                                                                                                  
 tf.math.add_1 (TFOpLambda)     (None, 2500, 512)    0           ['decode_4[0][0]',               
                                                                  'tf.identity_3[0][0]']          
                                                                                                  
 decode_3 (Sequential)          (None, 10004, 256)   1574144     ['tf.math.add_1[0][0]']          
                                                                                                  
 tf.identity_2 (TFOpLambda)     (None, 10004, 256)   0           ['encode_2[0][0]']               
                                                                                                  
 tf.math.add_2 (TFOpLambda)     (None, 10004, 256)   0           ['decode_3[0][0]',               
                                                                  'tf.identity_2[0][0]']          
                                                                                                  
 decode_2 (Sequential)          (None, 40020, 128)   393856      ['tf.math.add_2[0][0]']          
                                                                                                  
 tf.identity_1 (TFOpLambda)     (None, 40020, 128)   0           ['encode_1[0][0]']               
                                                                                                  
 tf.math.add_3 (TFOpLambda)     (None, 40020, 128)   0           ['decode_2[0][0]',               
                                                                  'tf.identity_1[0][0]']          
                                                                                                  
 decode_1 (Sequential)          (None, 160084, 64)   98624       ['tf.math.add_3[0][0]']          
                                                                                                  
 tf.identity (TFOpLambda)       (None, 160084, 64)   0           ['encode_0[0][0]']               
                                                                                                  
 tf.math.add_4 (TFOpLambda)     (None, 160084, 64)   0           ['decode_1[0][0]',               
                                                                  'tf.identity[0][0]']            
                                                                                                  
 decode_0 (Sequential)          (None, 640340, 1)    8833        ['tf.math.add_4[0][0]']          
                                                                                                  
 tf.__operators__.getitem_1 (Sl  (None, 320170, 1)   0           ['decode_0[0][0]']               
 icingOpLambda)                                                                                   
                                                                                                  
 tf.reshape_6 (TFOpLambda)      (None, 320170, 1)    0           ['tf.__operators__.getitem_1[0][0
                                                                 ]']                              
                                                                                                  
 tf.compat.v1.pad_1 (TFOpLambda  (None, 320172, 1)   0           ['tf.reshape_6[0][0]']           
 )                                                                                                
                                                                                                  
 tf.compat.v1.nn.conv1d_2 (TFOp  (None, 320172, 1)   0           ['tf.compat.v1.pad_1[0][0]']     
 Lambda)                                                                                          
                                                                                                  
 tf.__operators__.getitem_2 (Sl  (None, 320170, 1)   0           ['tf.compat.v1.nn.conv1d_2[0][0]'
 icingOpLambda)                                                  ]                                
                                                                                                  
 tf.__operators__.getitem (Slic  (None, 320170, 1)   0           ['decode_0[0][0]']               
 ingOpLambda)                                                                                     
                                                                                                  
 tf.reshape_7 (TFOpLambda)      (None, 320170, 1)    0           ['tf.__operators__.getitem_2[0][0
                                                                 ]']                              
                                                                                                  
 tf.__operators__.add_1 (TFOpLa  (None, 320170, 1)   0           ['tf.__operators__.getitem[0][0]'
 mbda)                                                           , 'tf.reshape_7[0][0]']          
                                                                                                  
 tf.reshape_8 (TFOpLambda)      (None, 320170, 1)    0           ['tf.__operators__.add_1[0][0]'] 
                                                                                                  
 tf.math.multiply (TFOpLambda)  (None, 320170, 1)    0           ['tf.reshape_8[0][0]']           
                                                                                                  
 tf.__operators__.getitem_4 (Sl  (None, 160085, 1)   0           ['tf.math.multiply[0][0]']       
 icingOpLambda)                                                                                   
                                                                                                  
 tf.reshape_9 (TFOpLambda)      (None, 160085, 1)    0           ['tf.__operators__.getitem_4[0][0
                                                                 ]']                              
                                                                                                  
 tf.compat.v1.pad_2 (TFOpLambda  (None, 160087, 1)   0           ['tf.reshape_9[0][0]']           
 )                                                                                                
                                                                                                  
 tf.compat.v1.nn.conv1d_3 (TFOp  (None, 160087, 1)   0           ['tf.compat.v1.pad_2[0][0]']     
 Lambda)                                                                                          
                                                                                                  
 tf.__operators__.getitem_5 (Sl  (None, 160085, 1)   0           ['tf.compat.v1.nn.conv1d_3[0][0]'
 icingOpLambda)                                                  ]                                
                                                                                                  
 tf.__operators__.getitem_3 (Sl  (None, 160085, 1)   0           ['tf.math.multiply[0][0]']       
 icingOpLambda)                                                                                   
                                                                                                  
 tf.reshape_10 (TFOpLambda)     (None, 160085, 1)    0           ['tf.__operators__.getitem_5[0][0
                                                                 ]']                              
                                                                                                  
 tf.__operators__.add_2 (TFOpLa  (None, 160085, 1)   0           ['tf.__operators__.getitem_3[0][0
 mbda)                                                           ]',                              
                                                                  'tf.reshape_10[0][0]']          
                                                                                                  
 tf.reshape_11 (TFOpLambda)     (None, 160085, 1)    0           ['tf.__operators__.add_2[0][0]'] 
                                                                                                  
 tf.math.multiply_1 (TFOpLambda  (None, 160085, 1)   0           ['tf.reshape_11[0][0]']          
 )                                                                                                
                                                                                                  
 tf.__operators__.getitem_6 (Sl  (None, 160000, 1)   0           ['tf.math.multiply_1[0][0]']     
 icingOpLambda)                                                                                   
                                                                                                  
 tf.math.multiply_2 (TFOpLambda  (None, 160000, 1)   0           ['tf.__operators__.getitem_6[0][0
 )                                                               ]',                              
                                                                  'tf.math.reduce_std[0][0]']     
                                                                                                  
==================================================================================================
Total params: 33,525,377
Trainable params: 33,525,377
Non-trainable params: 0
__________________________________________________________________________________________________
None
Created a new model
Restoring from /media/inverseai/432e68df-5f7f-44a3-ac5b-f984da69470d/inverseai/train/noise_reducer_16k_last/checkpoints/checkpoint_epoch-003_loss-0.019663.h5
Len  {'clean': <tf.Tensor 'ParseExample/ParseExampleV2:0' shape=(16, 160000) dtype=float32>, 'noisy': <tf.Tensor 'ParseExample/ParseExampleV2:1' shape=(16, 160000) dtype=float32>}
Epoch 1/10
  1/100 [..............................] - ETA: 16:06 - loss: 0.0208  2/100 [..............................] - ETA: 1:08 - loss: 0.0176   3/100 [..............................] - ETA: 1:07 - loss: 0.0163  4/100 [>.............................] - ETA: 1:06 - loss: 0.0146  5/100 [>.............................] - ETA: 1:05 - loss: 0.0151  6/100 [>.............................] - ETA: 1:04 - loss: 0.0149  7/100 [=>............................] - ETA: 1:04 - loss: 0.0143  8/100 [=>............................] - ETA: 1:03 - loss: 0.0142  9/100 [=>............................] - ETA: 1:02 - loss: 0.0137 10/100 [==>...........................] - ETA: 1:02 - loss: 0.0133 11/100 [==>...........................] - ETA: 1:01 - loss: 0.0131 12/100 [==>...........................] - ETA: 1:00 - loss: 0.0129 13/100 [==>...........................] - ETA: 1:00 - loss: 0.0128 14/100 [===>..........................] - ETA: 59s - loss: 0.0128  15/100 [===>..........................] - ETA: 58s - loss: 0.0124 16/100 [===>..........................] - ETA: 58s - loss: 0.0123 17/100 [====>.........................] - ETA: 57s - loss: 0.0121 18/100 [====>.........................] - ETA: 56s - loss: 0.0120 19/100 [====>.........................] - ETA: 56s - loss: 0.0118 20/100 [=====>........................] - ETA: 55s - loss: 0.0116 21/100 [=====>........................] - ETA: 54s - loss: 0.0115 22/100 [=====>........................] - ETA: 53s - loss: 0.0114 23/100 [=====>........................] - ETA: 53s - loss: 0.0113 24/100 [======>.......................] - ETA: 52s - loss: 0.0115 25/100 [======>.......................] - ETA: 51s - loss: 0.0114 26/100 [======>.......................] - ETA: 51s - loss: 0.0114 27/100 [=======>......................] - ETA: 50s - loss: 0.0116 28/100 [=======>......................] - ETA: 49s - loss: 0.0116 29/100 [=======>......................] - ETA: 49s - loss: 0.0116 30/100 [========>.....................] - ETA: 48s - loss: 0.0115 31/100 [========>.....................] - ETA: 47s - loss: 0.0115 32/100 [========>.....................] - ETA: 46s - loss: 0.0116 33/100 [========>.....................] - ETA: 46s - loss: 0.0115 34/100 [=========>....................] - ETA: 45s - loss: 0.0113 35/100 [=========>....................] - ETA: 44s - loss: 0.0113 36/100 [=========>....................] - ETA: 44s - loss: 0.0113 37/100 [==========>...................] - ETA: 43s - loss: 0.0113 38/100 [==========>...................] - ETA: 42s - loss: 0.0112 39/100 [==========>...................] - ETA: 42s - loss: 0.0112 40/100 [===========>..................] - ETA: 41s - loss: 0.0113 41/100 [===========>..................] - ETA: 40s - loss: 0.0112 42/100 [===========>..................] - ETA: 40s - loss: 0.0111 43/100 [===========>..................] - ETA: 39s - loss: 0.0111 44/100 [============>.................] - ETA: 38s - loss: 0.0111 45/100 [============>.................] - ETA: 37s - loss: 0.0110 46/100 [============>.................] - ETA: 37s - loss: 0.0109 47/100 [=============>................] - ETA: 36s - loss: 0.0109 48/100 [=============>................] - ETA: 35s - loss: 0.0109 49/100 [=============>................] - ETA: 35s - loss: 0.0110 50/100 [==============>...............] - ETA: 34s - loss: 0.0109 51/100 [==============>...............] - ETA: 33s - loss: 0.0109 52/100 [==============>...............] - ETA: 33s - loss: 0.0109 53/100 [==============>...............] - ETA: 32s - loss: 0.0108 54/100 [===============>..............] - ETA: 31s - loss: 0.0107 55/100 [===============>..............] - ETA: 31s - loss: 0.0107 56/100 [===============>..............] - ETA: 30s - loss: 0.0107 57/100 [================>.............] - ETA: 29s - loss: 0.0107 58/100 [================>.............] - ETA: 28s - loss: 0.0106 59/100 [================>.............] - ETA: 28s - loss: 0.0107 60/100 [=================>............] - ETA: 27s - loss: 0.0107 61/100 [=================>............] - ETA: 26s - loss: 0.0107 62/100 [=================>............] - ETA: 26s - loss: 0.0106 63/100 [=================>............] - ETA: 25s - loss: 0.0105 64/100 [==================>...........] - ETA: 24s - loss: 0.0105 65/100 [==================>...........] - ETA: 24s - loss: 0.0105 66/100 [==================>...........] - ETA: 23s - loss: 0.0105 67/100 [===================>..........] - ETA: 22s - loss: 0.0105 68/100 [===================>..........] - ETA: 22s - loss: 0.0105 69/100 [===================>..........] - ETA: 21s - loss: 0.0105 70/100 [====================>.........] - ETA: 20s - loss: 0.0105 71/100 [====================>.........] - ETA: 20s - loss: 0.0105 72/100 [====================>.........] - ETA: 19s - loss: 0.0104 73/100 [====================>.........] - ETA: 18s - loss: 0.0104 74/100 [=====================>........] - ETA: 17s - loss: 0.0104 75/100 [=====================>........] - ETA: 17s - loss: 0.0104 76/100 [=====================>........] - ETA: 16s - loss: 0.0103 77/100 [======================>.......] - ETA: 15s - loss: 0.0103 78/100 [======================>.......] - ETA: 15s - loss: 0.0103 79/100 [======================>.......] - ETA: 14s - loss: 0.0103 80/100 [=======================>......] - ETA: 13s - loss: 0.0102 81/100 [=======================>......] - ETA: 13s - loss: 0.0102 82/100 [=======================>......] - ETA: 12s - loss: 0.0102 83/100 [=======================>......] - ETA: 11s - loss: 0.0101 84/100 [========================>.....] - ETA: 11s - loss: 0.0101 85/100 [========================>.....] - ETA: 10s - loss: 0.0101 86/100 [========================>.....] - ETA: 9s - loss: 0.0101  87/100 [=========================>....] - ETA: 8s - loss: 0.0101 88/100 [=========================>....] - ETA: 8s - loss: 0.0100 89/100 [=========================>....] - ETA: 7s - loss: 0.0100 90/100 [==========================>...] - ETA: 6s - loss: 0.0100 91/100 [==========================>...] - ETA: 6s - loss: 0.0100 92/100 [==========================>...] - ETA: 5s - loss: 0.0100 93/100 [==========================>...] - ETA: 4s - loss: 0.0100 94/100 [===========================>..] - ETA: 4s - loss: 0.0100 95/100 [===========================>..] - ETA: 3s - loss: 0.0099 96/100 [===========================>..] - ETA: 2s - loss: 0.0099 97/100 [============================>.] - ETA: 2s - loss: 0.0099 98/100 [============================>.] - ETA: 1s - loss: 0.0099 99/100 [============================>.] - ETA: 0s - loss: 0.0098100/100 [==============================] - ETA: 0s - loss: 0.0098Batch size 16
Number of GPUs we have: 2
Len  {'clean': <tf.Tensor 'ParseExample/ParseExampleV2:0' shape=(16, 160000) dtype=float32>, 'noisy': <tf.Tensor 'ParseExample/ParseExampleV2:1' shape=(16, 160000) dtype=float32>}
Created a new model
Batch size 16
Number of GPUs we have: 2
Len  {'clean': <tf.Tensor 'ParseExample/ParseExampleV2:0' shape=(16, 160000) dtype=float32>, 'noisy': <tf.Tensor 'ParseExample/ParseExampleV2:1' shape=(16, 160000) dtype=float32>}
Created a new model
Model: "demucs"
__________________________________________________________________________________________________
 Layer (type)                   Output Shape         Param #     Connected to                     
==================================================================================================
 input_layer (InputLayer)       [(None, 160000, 1)]  0           []                               
                                                                                                  
 tf.math.reduce_std (TFOpLambda  (None, 1, 1)        0           ['input_layer[0][0]']            
 )                                                                                                
                                                                                                  
 tf.__operators__.add (TFOpLamb  (None, 1, 1)        0           ['tf.math.reduce_std[0][0]']     
 da)                                                                                              
                                                                                                  
 tf.math.truediv (TFOpLambda)   (None, 160000, 1)    0           ['input_layer[0][0]',            
                                                                  'tf.__operators__.add[0][0]']   
                                                                                                  
 tf.compat.v1.pad (TFOpLambda)  (None, 160085, 1)    0           ['tf.math.truediv[0][0]']        
                                                                                                  
 tf.reshape (TFOpLambda)        (None, 160085, 1)    0           ['tf.compat.v1.pad[0][0]']       
                                                                                                  
 tf.compat.v1.nn.conv1d (TFOpLa  (None, 160085, 1)   0           ['tf.reshape[0][0]']             
 mbda)                                                                                            
                                                                                                  
 tf.reshape_1 (TFOpLambda)      (None, 160085, 1)    0           ['tf.compat.v1.nn.conv1d[0][0]'] 
                                                                                                  
 tf.stack (TFOpLambda)          (None, 160085, 2, 1  0           ['tf.compat.v1.pad[0][0]',       
                                )                                 'tf.reshape_1[0][0]']           
                                                                                                  
 tf.reshape_2 (TFOpLambda)      (None, 320170, 1)    0           ['tf.stack[0][0]']               
                                                                                                  
 tf.reshape_3 (TFOpLambda)      (None, 320170, 1)    0           ['tf.reshape_2[0][0]']           
                                                                                                  
 tf.compat.v1.nn.conv1d_1 (TFOp  (None, 320170, 1)   0           ['tf.reshape_3[0][0]']           
 Lambda)                                                                                          
                                                                                                  
 tf.reshape_4 (TFOpLambda)      (None, 320170, 1)    0           ['tf.compat.v1.nn.conv1d_1[0][0]'
                                                                 ]                                
                                                                                                  
 tf.stack_1 (TFOpLambda)        (None, 320170, 2, 1  0           ['tf.reshape_2[0][0]',           
                                )                                 'tf.reshape_4[0][0]']           
                                                                                                  
 tf.reshape_5 (TFOpLambda)      (None, 640340, 1)    0           ['tf.stack_1[0][0]']             
                                                                                                  
 encode_0 (Sequential)          (None, 160084, 64)   8896        ['tf.reshape_5[0][0]']           
                                                                                                  
 encode_1 (Sequential)          (None, 40020, 128)   98688       ['encode_0[0][0]']               
                                                                                                  
 encode_2 (Sequential)          (None, 10004, 256)   393984      ['encode_1[0][0]']               
                                                                                                  
 encode_3 (Sequential)          (None, 2500, 512)    1574400     ['encode_2[0][0]']               
                                                                                                  
 encode_4 (Sequential)          (None, 624, 1024)    6294528     ['encode_3[0][0]']               
                                                                                                  
 sequential (Sequential)        (None, 624, 1024)    16785408    ['encode_4[0][0]']               
                                                                                                  
 tf.identity_4 (TFOpLambda)     (None, 624, 1024)    0           ['encode_4[0][0]']               
                                                                                                  
 tf.math.add (TFOpLambda)       (None, 624, 1024)    0           ['sequential[0][0]',             
                                                                  'tf.identity_4[0][0]']          
                                                                                                  
 decode_4 (Sequential)          (None, 2500, 512)    6294016     ['tf.math.add[0][0]']            
                                                                                                  
 tf.identity_3 (TFOpLambda)     (None, 2500, 512)    0           ['encode_3[0][0]']               
                                                                                                  
 tf.math.add_1 (TFOpLambda)     (None, 2500, 512)    0           ['decode_4[0][0]',               
                                                                  'tf.identity_3[0][0]']          
                                                                                                  
 decode_3 (Sequential)          (None, 10004, 256)   1574144     ['tf.math.add_1[0][0]']          
                                                                                                  
 tf.identity_2 (TFOpLambda)     (None, 10004, 256)   0           ['encode_2[0][0]']               
                                                                                                  
 tf.math.add_2 (TFOpLambda)     (None, 10004, 256)   0           ['decode_3[0][0]',               
                                                                  'tf.identity_2[0][0]']          
                                                                                                  
 decode_2 (Sequential)          (None, 40020, 128)   393856      ['tf.math.add_2[0][0]']          
                                                                                                  
 tf.identity_1 (TFOpLambda)     (None, 40020, 128)   0           ['encode_1[0][0]']               
                                                                                                  
 tf.math.add_3 (TFOpLambda)     (None, 40020, 128)   0           ['decode_2[0][0]',               
                                                                  'tf.identity_1[0][0]']          
                                                                                                  
 decode_1 (Sequential)          (None, 160084, 64)   98624       ['tf.math.add_3[0][0]']          
                                                                                                  
 tf.identity (TFOpLambda)       (None, 160084, 64)   0           ['encode_0[0][0]']               
                                                                                                  
 tf.math.add_4 (TFOpLambda)     (None, 160084, 64)   0           ['decode_1[0][0]',               
                                                                  'tf.identity[0][0]']            
                                                                                                  
 decode_0 (Sequential)          (None, 640340, 1)    8833        ['tf.math.add_4[0][0]']          
                                                                                                  
 tf.__operators__.getitem_1 (Sl  (None, 320170, 1)   0           ['decode_0[0][0]']               
 icingOpLambda)                                                                                   
                                                                                                  
 tf.reshape_6 (TFOpLambda)      (None, 320170, 1)    0           ['tf.__operators__.getitem_1[0][0
                                                                 ]']                              
                                                                                                  
 tf.compat.v1.pad_1 (TFOpLambda  (None, 320172, 1)   0           ['tf.reshape_6[0][0]']           
 )                                                                                                
                                                                                                  
 tf.compat.v1.nn.conv1d_2 (TFOp  (None, 320172, 1)   0           ['tf.compat.v1.pad_1[0][0]']     
 Lambda)                                                                                          
                                                                                                  
 tf.__operators__.getitem_2 (Sl  (None, 320170, 1)   0           ['tf.compat.v1.nn.conv1d_2[0][0]'
 icingOpLambda)                                                  ]                                
                                                                                                  
 tf.__operators__.getitem (Slic  (None, 320170, 1)   0           ['decode_0[0][0]']               
 ingOpLambda)                                                                                     
                                                                                                  
 tf.reshape_7 (TFOpLambda)      (None, 320170, 1)    0           ['tf.__operators__.getitem_2[0][0
                                                                 ]']                              
                                                                                                  
 tf.__operators__.add_1 (TFOpLa  (None, 320170, 1)   0           ['tf.__operators__.getitem[0][0]'
 mbda)                                                           , 'tf.reshape_7[0][0]']          
                                                                                                  
 tf.reshape_8 (TFOpLambda)      (None, 320170, 1)    0           ['tf.__operators__.add_1[0][0]'] 
                                                                                                  
 tf.math.multiply (TFOpLambda)  (None, 320170, 1)    0           ['tf.reshape_8[0][0]']           
                                                                                                  
 tf.__operators__.getitem_4 (Sl  (None, 160085, 1)   0           ['tf.math.multiply[0][0]']       
 icingOpLambda)                                                                                   
                                                                                                  
 tf.reshape_9 (TFOpLambda)      (None, 160085, 1)    0           ['tf.__operators__.getitem_4[0][0
                                                                 ]']                              
                                                                                                  
 tf.compat.v1.pad_2 (TFOpLambda  (None, 160087, 1)   0           ['tf.reshape_9[0][0]']           
 )                                                                                                
                                                                                                  
 tf.compat.v1.nn.conv1d_3 (TFOp  (None, 160087, 1)   0           ['tf.compat.v1.pad_2[0][0]']     
 Lambda)                                                                                          
                                                                                                  
 tf.__operators__.getitem_5 (Sl  (None, 160085, 1)   0           ['tf.compat.v1.nn.conv1d_3[0][0]'
 icingOpLambda)                                                  ]                                
                                                                                                  
 tf.__operators__.getitem_3 (Sl  (None, 160085, 1)   0           ['tf.math.multiply[0][0]']       
 icingOpLambda)                                                                                   
                                                                                                  
 tf.reshape_10 (TFOpLambda)     (None, 160085, 1)    0           ['tf.__operators__.getitem_5[0][0
                                                                 ]']                              
                                                                                                  
 tf.__operators__.add_2 (TFOpLa  (None, 160085, 1)   0           ['tf.__operators__.getitem_3[0][0
 mbda)                                                           ]',                              
                                                                  'tf.reshape_10[0][0]']          
                                                                                                  
 tf.reshape_11 (TFOpLambda)     (None, 160085, 1)    0           ['tf.__operators__.add_2[0][0]'] 
                                                                                                  
 tf.math.multiply_1 (TFOpLambda  (None, 160085, 1)   0           ['tf.reshape_11[0][0]']          
 )                                                                                                
                                                                                                  
 tf.__operators__.getitem_6 (Sl  (None, 160000, 1)   0           ['tf.math.multiply_1[0][0]']     
 icingOpLambda)                                                                                   
                                                                                                  
 tf.math.multiply_2 (TFOpLambda  (None, 160000, 1)   0           ['tf.__operators__.getitem_6[0][0
 )                                                               ]',                              
                                                                  'tf.math.reduce_std[0][0]']     
                                                                                                  
==================================================================================================
Total params: 33,525,377
Trainable params: 33,525,377
Non-trainable params: 0
__________________________________________________________________________________________________
None
Len  {'clean': <tf.Tensor 'ParseExample/ParseExampleV2:0' shape=(16, 160000) dtype=float32>, 'noisy': <tf.Tensor 'ParseExample/ParseExampleV2:1' shape=(16, 160000) dtype=float32>}
Epoch 1/10
 1/10 [==>...........................] - ETA: 1:28 - loss: 0.0321 2/10 [=====>........................] - ETA: 5s - loss: 0.0300   3/10 [========>.....................] - ETA: 4s - loss: 0.0311 4/10 [===========>..................] - ETA: 4s - loss: 0.0305 5/10 [==============>...............] - ETA: 3s - loss: 0.0304 6/10 [=================>............] - ETA: 2s - loss: 0.0325 7/10 [====================>.........] - ETA: 2s - loss: 0.0335 8/10 [=======================>......] - ETA: 1s - loss: 0.0330 9/10 [==========================>...] - ETA: 0s - loss: 0.032510/10 [==============================] - ETA: 0s - loss: 0.033310/10 [==============================] - 16s 726ms/step - loss: 0.0333
Epoch 2/10
 1/10 [==>...........................] - ETA: 6s - loss: 0.0390 2/10 [=====>........................] - ETA: 5s - loss: 0.0354 3/10 [========>.....................] - ETA: 4s - loss: 0.0329 4/10 [===========>..................] - ETA: 4s - loss: 0.0322 5/10 [==============>...............] - ETA: 3s - loss: 0.0329 6/10 [=================>............] - ETA: 2s - loss: 0.0329 7/10 [====================>.........] - ETA: 2s - loss: 0.0334 8/10 [=======================>......] - ETA: 1s - loss: 0.0334 9/10 [==========================>...] - ETA: 0s - loss: 0.032510/10 [==============================] - ETA: 0s - loss: 0.032410/10 [==============================] - 11s 1s/step - loss: 0.0324 - val_loss: 0.0314
Epoch 3/10
 1/10 [==>...........................] - ETA: 6s - loss: 0.0382 2/10 [=====>........................] - ETA: 5s - loss: 0.0373 3/10 [========>.....................] - ETA: 4s - loss: 0.0350 4/10 [===========>..................] - ETA: 4s - loss: 0.0332 5/10 [==============>...............] - ETA: 3s - loss: 0.0351 6/10 [=================>............] - ETA: 2s - loss: 0.0339 7/10 [====================>.........] - ETA: 2s - loss: 0.0343Batch size 16
Number of GPUs we have: 2
Created a new model
